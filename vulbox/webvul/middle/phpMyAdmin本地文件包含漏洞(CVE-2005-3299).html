
<!DOCTYPE html>

<html>

	<head>

		<meta charset="utf-8">

        <link rel="stylesheet" href="/vulbox/source/table.css" />

	</head>

	<body class="dialog">

		<div class="content">

			<div class="wrap">

				<div class="cont">

					<table class="table table-hover table-mc-light-blue" style="margin-top: 0;">

						<thead>

							<tr class="first_title">

								<th colspan="2">漏洞描述</th>

							</tr>

						</thead>

						<tbody>

							<tr>

								<th width="70">漏洞名称</th>

								<td>

								    <img style="float:left;" src="/vulbox/source/m.gif" align="absmiddle"/>

								<span style="float:left;margin-top:1px;margin-top:2px\9;">phpMyAdmin本地文件包含漏洞(CVE-2005-3299)</span>

								</td>

							</tr>

							<tr>

								<th valign="top">详细描述</th>

								<td valign="top">

									phpMyAdmin是一个免费工具，为管理MySQL提供了一个WWW管理接口。<br />

									<br />

									phpMyAdmin中存在严重的本地文件包含漏洞。在/libraries/grab_globals.lib.php文件中：<br />

									<br />

									- -101-104-grab_globals.lib.php---------<br />

									if ( ! empty( $__redirect ) ) {<br />

									    require(&#39;./&#39; . $__redirect);<br />

									    exit();<br />

									} // end if ( ! empty( $__redirect ) )<br />

									- -101-104-grab_globals.lib.php---------<br />

									<br />

									但在这之前：<br />

									<br />

									- -53-67-grab_globals.lib.php-----------<br />

									// check if a subform is submitted<br />

									$__redirect = NULL;<br />

									if ( isset( $_POST[&#39;usesubform&#39;] ) ) {<br />

									    // if a subform is present and should be used<br />

									    // the rest of the form is deprecated<br />

									    $subform_id = key( $_POST[&#39;usesubform&#39;] );<br />

									    $subform    = $_POST[&#39;subform&#39;][$subform_id];<br />

									    $_POST      = $subform;<br />

									    if ( isset( $_POST[&#39;redirect&#39;] ) <br />

									      &amp;&amp; $_POST[&#39;redirect&#39;] != basename( $_SERVER[&#39;PHP_SELF&#39;] ) ) {<br />

									        $__redirect = $_POST[&#39;redirect&#39;];<br />

									        unset( $_POST[&#39;redirect&#39;] );<br />

									    } // end if ( isset( $_POST[&#39;redirect&#39;] ) )<br />

									} // end if ( isset( $_POST[&#39;usesubform&#39;] ) )<br />

									// end check if a subform is submitted<br />

									- -53-67-grab_globals.lib.php-----------<br />

									<br />

									因此如果存在$_POST[&#39;usesubform&#39;]变量且为数组的话，攻击者就可以为$_POST（如$_POST[&#39;redirect&#39;]）创建新的变量：<br />

									<br />

									    $subform    = $_POST[&#39;subform&#39;][$subform_id];<br />

									    $_POST      = $subform;<br />

									<br />

									在这里$_POST数组 = $_POST[subform][1]数组，$_POST[&#39;redirect&#39;]=$_POST[subform][1][redirect]<br />

									<br />

									因此攻击者可以包含进本地文件。<br />

									<br />

									攻击者可以利用这个漏洞在受影响计算机上以Web server进程的权限执行任意服务器端脚本。<br />

								</td>

							</tr>

							<tr>

								<th  valign="top">解决方案</th>

								<td valign="top">

									phpMyAdmin<br />

									----------<br />

									目前厂商已经发布了升级补丁以修复此安全问题，补丁获取链接：<br />

									<br />

									http://www.phpmyadmin.net/home_page/downloads.php<br />

								</td>

							</tr>

							<tr>

								<th>威胁分值</th>

								<td>5</td>

							</tr>

							<tr>

								<th>危险插件</th>

								<td>否</td>

							</tr>

							<tr>

                                <th>发现日期</th>

                                <td>2005-10-23</td>

                            </tr>

							<tr>

                                <th>发布日期</th>

                                <td>2013-11-13</td>

                            </tr>

							<tr>

								<th>CVE</th>

								<td>

									<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3299" target="_blank">CVE-2005-3299</a>&nbsp;

								</td>

							</tr>

							<tr>

								<th>BUGTRAQ</th>

								<td>

									<a href="http://www.securityfocus.com/bid/15053" target="_blank">15053</a>

								</td>

							</tr>

							<tr>

								<th>NSFOCUS</th>

								<td>

									<a href="http://www.nsfocus.net/index.php?act=sec_bug&do=view&bug_id=8125" target="_blank">8125</a>

								</td>

							</tr>

							<tr>

								<th>CNNVD编号</th>

								<td>

									CNNVD-200510-183&nbsp;&nbsp;

								</td>

							</tr>

							<tr>

								<th>CNCVE编号</th>

								<td>

									CNCVE-20053299&nbsp;&nbsp;

								</td>

							</tr>

							<tr>

								<th>CVSS评分</th>

								<td>

									5.0&nbsp;&nbsp;

								</td>

							</tr>

							<tr>

								<th>CNVD编号</th>

								<td>

									CNVD-2009-08125&nbsp;&nbsp;

								</td>

							</tr>

						</tbody>

					</table>

				</div>

			</div>

		</div>

	</body>

</html>