
<!DOCTYPE html>

<html>

	<head>

		<meta charset="utf-8">

        <link rel="stylesheet" href="/vulbox/source/table.css" />

	</head>

	<body class="dialog">

		<div class="content">

			<div class="wrap">

				<div class="cont">

					<table class="table table-hover table-mc-light-blue" style="margin-top: 0;">

						<thead>

							<tr class="first_title">

								<th colspan="2">漏洞描述</th>

							</tr>

						</thead>

						<tbody>

							<tr>

								<th width="70">漏洞名称</th>

								<td>

								    <img style="float:left;" src="/vulbox/source/h.gif" align="absmiddle"/>

								<span style="float:left;margin-top:1px;margin-top:2px\9;">PHP3 &#39;safe_mode&#39;失效漏洞(CVE-2000-0059)</span>

								</td>

							</tr>

							<tr>

								<th valign="top">详细描述</th>

								<td valign="top">

									含有安全模式的PHP3无法正确地从相关函数执行的命令中过滤shell元字符。远程攻击者可以利用此漏洞执行命令。<br />

								</td>

							</tr>

							<tr>

								<th  valign="top">解决方案</th>

								<td valign="top">

									Index: functions/file.c<br />

									        ===================================================================<br />

									        RCS file: /repository/php3/functions/file.c,v<br />

									        retrieving revision 1.229<br />

									        retrieving revision 1.230<br />

									        diff -u -r1.229 -r1.230<br />

									        --- functions/file.c 2000/01/01 04:31:15 1.229<br />

									        +++ functions/file.c 2000/01/03 21:31:31 1.230<br />

									        @@ -26,7 +26,7 @@<br />

									         | Authors: Rasmus Lerdorf |<br />

									         +----------------------------------------------------------------------+<br />

									         */<br />

									        -/* $Id: file.c,v 1.229 2000/01/01 04:31:15 sas Exp $ */<br />

									        +/* $Id: file.c,v 1.230 2000/01/03 21:31:31 kk Exp $ */<br />

									         #include &quot;php.h&quot;<br />

									        #include <br />

									        @@ -51,6 +51,7 @@<br />

									         #include &quot;safe_mode.h&quot;<br />

									         #include &quot;php3_list.h&quot;<br />

									         #include &quot;php3_string.h&quot;<br />

									        +#include &quot;exec.h&quot;<br />

									         #include &quot;file.h&quot;<br />

									         #if HAVE_PWD_H<br />

									         #if MSVC5<br />

									        @@ -575,7 +576,7 @@<br />

									         pval *arg1, *arg2;<br />

									         FILE *fp;<br />

									         int id;<br />

									        - char *p;<br />

									        + char *p, *tmp = NULL;<br />

									         char *b, buf[1024];<br />

									         TLS_VARS;<br />

									        @@ -600,7 +601,11 @@<br />

									         } else {<br />

									         snprintf(buf,sizeof(buf),&quot;/&quot;,php3_ini.safe_mode_exec_dir,arg1-&gt;value.str.val);<br />

									         }<br />

									        - fp = popen(buf,p);<br />

									        +<br />

									        + tmp = _php3_escapeshellcmd(buf);<br />

									        + fp = popen(tmp,p);<br />

									        + efree(tmp); /* temporary copy, no longer necessary */<br />

									        +<br />

									         if (!fp) {<br />

									         php3_error(E_WARNING,&quot;popen(\\&quot;\\&quot;,\\&quot;\\&quot;) - &quot;,buf,p,strerror(errno));<br />

									         RETURN_FALSE;<br />

								</td>

							</tr>

							<tr>

								<th>威胁分值</th>

								<td>10</td>

							</tr>

							<tr>

								<th>危险插件</th>

								<td>否</td>

							</tr>

							<tr>

                                <th>发现日期</th>

                                <td>2000-01-04</td>

                            </tr>

							<tr>

                                <th>发布日期</th>

                                <td>2013-07-08</td>

                            </tr>

							<tr>

								<th>CVE</th>

								<td>

									<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0059" target="_blank">CVE-2000-0059</a>&nbsp;

								</td>

							</tr>

							<tr>

								<th>BUGTRAQ</th>

								<td>

									<a href="http://www.securityfocus.com/bid/911" target="_blank">911</a>

								</td>

							</tr>

							<tr>

								<th>CNNVD编号</th>

								<td>

									CNNVD-200001-007&nbsp;&nbsp;

								</td>

							</tr>

							<tr>

								<th>CNCVE编号</th>

								<td>

									CNCVE-20000059&nbsp;&nbsp;

								</td>

							</tr>

							<tr>

								<th>CVSS评分</th>

								<td>

									10.0&nbsp;&nbsp;

								</td>

							</tr>

						</tbody>

					</table>

				</div>

			</div>

		</div>

	</body>

</html>