
<!DOCTYPE html>

<html>

	<head>

		<meta charset="utf-8">

        <link rel="stylesheet" href="/vulbox/source/table.css" />

	</head>

	<body class="dialog">

		<div class="content">

			<div class="wrap">

				<div class="cont">

					<table class="table table-hover table-mc-light-blue" style="margin-top: 0;">

						<thead>

							<tr class="first_title">

								<th colspan="2">漏洞描述</th>

							</tr>

						</thead>

						<tbody>

							<tr>

								<th width="70">漏洞名称</th>

								<td>

								    <img style="float:left;" src="/vulbox/source/l.gif" align="absmiddle"/>

								<span style="float:left;margin-top:1px;margin-top:2px\9;">Apahce HTDigest和HTPasssWD组件多个本地漏洞(CVE-2002-1233)</span>

								</td>

							</tr>

							<tr>

								<th valign="top">详细描述</th>

								<td valign="top">

									Apache是一款免费开放源代码的WEB服务程序。<br />

									<br />

									Apache存在多个漏洞可以导致安全问题，本地攻击者可以利用这些漏洞进行修改Apache密码文件内容等攻击。<br />

									<br />

									1、support/htpasswd.c中存在竞争条件漏洞：<br />

									<br />

									      main()<br />

									      tempfilename = tmpnam(tname_buf);<br />

									      ftemp = fopen(tempfilename, &quot;w+&quot;);<br />

									      ...<br />

									      copy_file(ftemp, fpw);<br />

									<br />

									当管理员运行htpasswd时攻击者利用这个漏洞可导致任意本地用户可以读取、修改Apache密码文件内容。<br />

									<br />

									2、support/htdigest.c存在竞争条件漏洞：<br />

									<br />

									      main()<br />

									      tn = tmpnam(NULL);<br />

									      if (!(tfp = fopen(tn, &quot;w&quot;))) ...<br />

									      ...<br />

									      sprintf(command, &quot;cp s s&quot;, tn, argv[1]);<br />

									      system(command);<br />

									当管理员运行htdigest时攻击者利用这个漏洞可导致任意本地用户可以读，修改Apache密码文件内容。<br />

									<br />

									3、support/htdigest.c:main()中包含多个不安全system()调用，不过htdigest不能从任何CGI脚本中调用。<br />

									<br />

									4、support/htdigest.c存在缓冲区溢出问题：<br />

									<br />

									  main()<br />

									缓冲区溢出存在多处，下面就是一个例子:<br />

									  #define MAX_STRING_LEN 256<br />

									  int main(int argc, char *argv[]) {<br />

									      char user[MAX_STRING_LEN];<br />

									      strcpy(user, argv[3]);<br />

									<br />

									不过htdigest不能从任何CGI脚本中调用，所以不存在远程缓冲区溢出利用的可能。<br />

								</td>

							</tr>

							<tr>

								<th  valign="top">解决方案</th>

								<td valign="top">

									Apache Group<br />

									------------<br />

									目前厂商已经发布了升级补丁以修复此安全问题，补丁获取链接：<br />

									<br />

									http://www.apache.org<br />

									<br />

									http://httpd.apache.org/download.cgi<br />

								</td>

							</tr>

							<tr>

								<th>威胁分值</th>

								<td>2</td>

							</tr>

							<tr>

								<th>危险插件</th>

								<td>否</td>

							</tr>

							<tr>

                                <th>发现日期</th>

                                <td>2002-11-04</td>

                            </tr>

							<tr>

                                <th>发布日期</th>

                                <td>2013-07-08</td>

                            </tr>

							<tr>

								<th>CVE</th>

								<td>

									<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1233" target="_blank">CVE-2002-1233</a>&nbsp;

								</td>

							</tr>

							<tr>

								<th>BUGTRAQ</th>

								<td>

									<a href="http://www.securityfocus.com/bid/5981" target="_blank">5981</a>

									<a href="http://www.securityfocus.com/bid/5990" target="_blank">5990</a>

								</td>

							</tr>

							<tr>

								<th>NSFOCUS</th>

								<td>

									<a href="http://www.nsfocus.net/index.php?act=sec_bug&do=view&bug_id=3695" target="_blank">3695</a>

								</td>

							</tr>

							<tr>

								<th>CNNVD编号</th>

								<td>

									CNNVD-200211-006
&nbsp;&nbsp;

								</td>

							</tr>

							<tr>

								<th>CNCVE编号</th>

								<td>

									CNCVE-20021233&nbsp;&nbsp;

								</td>

							</tr>

							<tr>

								<th>CVSS评分</th>

								<td>

									2.6&nbsp;&nbsp;

								</td>

							</tr>

							<tr>

								<th>CNVD编号</th>

								<td>

									CNVD-2009-03695&nbsp;&nbsp;

								</td>

							</tr>

						</tbody>

					</table>

				</div>

			</div>

		</div>

	</body>

</html>